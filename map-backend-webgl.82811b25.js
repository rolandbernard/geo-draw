(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{30:function(e,t,n){var r=n(31);function a(){return"undefined"!=typeof Reflect&&Reflect.get?(e.exports=a=Reflect.get,e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=a=function(e,t,n){var a=r(e,t);if(a){var o=Object.getOwnPropertyDescriptor(a,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},e.exports.__esModule=!0,e.exports.default=e.exports),a.apply(this,arguments)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},31:function(e,t,n){var r=n(17);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e},e.exports.__esModule=!0,e.exports.default=e.exports},48:function(e,t,n){"use strict";function r(e,t,n){n=n||2;var r,u,l,s,f,v,x,p=t&&t.length,m=p?t[0]*n:e.length,g=a(e,0,m,n,!0),y=[];if(!g||g.next===g.prev)return y;if(p&&(g=function(e,t,n,r){var i,u,l,s,f,v=[];for(i=0,u=t.length;i<u;i++)l=t[i]*r,s=i<u-1?t[i+1]*r:e.length,(f=a(e,l,s,r,!1))===f.next&&(f.steiner=!0),v.push(d(f));for(v.sort(c),i=0;i<v.length;i++)n=o(n=h(v[i],n),n.next);return n}(e,t,g,n)),e.length>80*n){r=l=e[0],u=s=e[1];for(var _=n;_<m;_+=n)(f=e[_])<r&&(r=f),(v=e[_+1])<u&&(u=v),f>l&&(l=f),v>s&&(s=v);x=0!==(x=Math.max(l-r,s-u))?1/x:0}return i(g,y,n,r,u,x),y}function a(e,t,n,r,a){var o,i;if(a===E(e,t,n,r)>0)for(o=t;o<n;o+=r)i=A(o,e[o],e[o+1],i);else for(o=n-r;o>=t;o-=r)i=A(o,e[o],e[o+1],i);return i&&y(i,i.next)&&(T(i),i=i.next),i}function o(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!y(r,r.next)&&0!==g(r.prev,r,r.next))r=r.next;else{if(T(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function i(e,t,n,r,a,c,h){if(e){!h&&c&&function(e,t,n,r){var a=e;do{null===a.z&&(a.z=x(a.x,a.y,t,n,r)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next}while(a!==e);a.prevZ.nextZ=null,a.prevZ=null,function(e){var t,n,r,a,o,i,u,l,s=1;do{for(n=e,e=null,o=null,i=0;n;){for(i++,r=n,u=0,t=0;t<s&&(u++,r=r.nextZ);t++);for(l=s;u>0||l>0&&r;)0!==u&&(0===l||!r||n.z<=r.z)?(a=n,n=n.nextZ,u--):(a=r,r=r.nextZ,l--),o?o.nextZ=a:e=a,a.prevZ=o,o=a;n=r}o.nextZ=null,s*=2}while(i>1)}(a)}(e,r,a,c);for(var v,d,p=e;e.prev!==e.next;)if(v=e.prev,d=e.next,c?l(e,r,a,c):u(e))t.push(v.i/n),t.push(e.i/n),t.push(d.i/n),T(e),e=d.next,p=d.next;else if((e=d)===p){h?1===h?i(e=s(o(e),t,n),t,n,r,a,c,2):2===h&&f(e,t,n,r,a,c):i(o(e),t,n,r,a,c,1);break}}}function u(e){var t=e.prev,n=e,r=e.next;if(g(t,n,r)>=0)return!1;for(var a=e.next.next;a!==e.prev;){if(p(t.x,t.y,n.x,n.y,r.x,r.y,a.x,a.y)&&g(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function l(e,t,n,r){var a=e.prev,o=e,i=e.next;if(g(a,o,i)>=0)return!1;for(var u=a.x<o.x?a.x<i.x?a.x:i.x:o.x<i.x?o.x:i.x,l=a.y<o.y?a.y<i.y?a.y:i.y:o.y<i.y?o.y:i.y,s=a.x>o.x?a.x>i.x?a.x:i.x:o.x>i.x?o.x:i.x,f=a.y>o.y?a.y>i.y?a.y:i.y:o.y>i.y?o.y:i.y,c=x(u,l,t,n,r),h=x(s,f,t,n,r),v=e.prevZ,d=e.nextZ;v&&v.z>=c&&d&&d.z<=h;){if(v!==e.prev&&v!==e.next&&p(a.x,a.y,o.x,o.y,i.x,i.y,v.x,v.y)&&g(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,d!==e.prev&&d!==e.next&&p(a.x,a.y,o.x,o.y,i.x,i.y,d.x,d.y)&&g(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;v&&v.z>=c;){if(v!==e.prev&&v!==e.next&&p(a.x,a.y,o.x,o.y,i.x,i.y,v.x,v.y)&&g(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;d&&d.z<=h;){if(d!==e.prev&&d!==e.next&&p(a.x,a.y,o.x,o.y,i.x,i.y,d.x,d.y)&&g(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function s(e,t,n){var r=e;do{var a=r.prev,i=r.next.next;!y(a,i)&&_(a,r,r.next,i)&&M(a,i)&&M(i,a)&&(t.push(a.i/n),t.push(r.i/n),t.push(i.i/n),T(r),T(r.next),r=e=i),r=r.next}while(r!==e);return o(r)}function f(e,t,n,r,a,u){var l=e;do{for(var s=l.next.next;s!==l.prev;){if(l.i!==s.i&&m(l,s)){var f=R(l,s);return l=o(l,l.next),f=o(f,f.next),i(l,t,n,r,a,u),void i(f,t,n,r,a,u)}s=s.next}l=l.next}while(l!==e)}function c(e,t){return e.x-t.x}function h(e,t){var n=function(e,t){var n,r=t,a=e.x,o=e.y,i=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var u=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(u<=a&&u>i){if(i=u,u===a){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(a===i)return n;var l,s=n,f=n.x,c=n.y,h=1/0;r=n;do{a>=r.x&&r.x>=f&&a!==r.x&&p(o<c?a:i,o,f,c,o<c?i:a,o,r.x,r.y)&&(l=Math.abs(o-r.y)/(a-r.x),M(r,e)&&(l<h||l===h&&(r.x>n.x||r.x===n.x&&v(n,r)))&&(n=r,h=l)),r=r.next}while(r!==s);return n}(e,t);if(!n)return t;var r=R(n,e),a=o(n,n.next);return o(r,r.next),t===n?a:t}function v(e,t){return g(e.prev,e,t.prev)<0&&g(t.next,e,e.next)<0}function x(e,t,n,r,a){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*a)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*a)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function d(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function p(e,t,n,r,a,o,i,u){return(a-i)*(t-u)-(e-i)*(o-u)>=0&&(e-i)*(r-u)-(n-i)*(t-u)>=0&&(n-i)*(o-u)-(a-i)*(r-u)>=0}function m(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&_(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(M(e,t)&&M(t,e)&&function(e,t){var n=e,r=!1,a=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&a<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(g(e.prev,e,t.prev)||g(e,t.prev,t))||y(e,t)&&g(e.prev,e,e.next)>0&&g(t.prev,t,t.next)>0)}function g(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function y(e,t){return e.x===t.x&&e.y===t.y}function _(e,t,n,r){var a=P(g(e,t,n)),o=P(g(e,t,r)),i=P(g(n,r,e)),u=P(g(n,r,t));return a!==o&&i!==u||(!(0!==a||!b(e,n,t))||(!(0!==o||!b(e,r,t))||(!(0!==i||!b(n,e,r))||!(0!==u||!b(n,t,r)))))}function b(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function P(e){return e>0?1:e<0?-1:0}function M(e,t){return g(e.prev,e,e.next)<0?g(e,t,e.next)>=0&&g(e,e.prev,t)>=0:g(e,t,e.prev)<0||g(e,e.next,t)<0}function R(e,t){var n=new w(e.i,e.x,e.y),r=new w(t.i,t.x,t.y),a=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=a,a.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function A(e,t,n,r){var a=new w(e,t,n);return r?(a.next=r.next,a.prev=r,r.next.prev=a,r.next=a):(a.prev=a,a.next=a),a}function T(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function w(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function E(e,t,n,r){for(var a=0,o=t,i=n-r;o<n;o+=r)a+=(e[i]-e[o])*(e[o+1]+e[i+1]),i=o;return a}e.exports=r,e.exports.default=r,r.deviation=function(e,t,n,r){var a=t&&t.length,o=a?t[0]*n:e.length,i=Math.abs(E(e,0,o,n));if(a)for(var u=0,l=t.length;u<l;u++){var s=t[u]*n,f=u<l-1?t[u+1]*n:e.length;i-=Math.abs(E(e,s,f,n))}var c=0;for(u=0;u<r.length;u+=3){var h=r[u]*n,v=r[u+1]*n,x=r[u+2]*n;c+=Math.abs((e[h]-e[x])*(e[v+1]-e[h+1])-(e[h]-e[v])*(e[x+1]-e[h+1]))}return 0===i&&0===c?0:Math.abs((c-i)/i)},r.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,a=0;a<e.length;a++){for(var o=0;o<e[a].length;o++)for(var i=0;i<t;i++)n.vertices.push(e[a][o][i]);a>0&&(r+=e[a-1].length,n.holes.push(r))}return n}},50:function(e,t,n){"use strict";n.r(t);var r=n(10),a=n.n(r),o=n(27),i=n.n(o),u=n(12),l=n.n(u),s=n(13),f=n.n(s),c=n(18),h=n.n(c),v=n(19),x=n.n(v),d=n(17),p=n.n(d),m=n(11),g=n(48),y=n.n(g),_=n(22),b=n.n(_),P=n(21);function M(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){u=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(u)throw o}}}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var A=function(){function e(){l()(this,e)}return f()(e,[{key:"projection",value:function(e){return P.a.project(e)}},{key:"applyProjection",value:function(e){for(var t=0;t<e.length;t+=2){var n=this.projection([e[t],e[t+1]]),r=b()(n,2);e[t]=r[0],e[t+1]=r[1]}}},{key:"clientPosToMapPos",value:function(e,t,n){var r=this.generateTranslateAndScale(n),a=b()(r,2),o=(a[0],a[1]),i=[2*(e[0]-t.x)/t.width-1,1-2*(e[1]-t.y)/t.height];return[i[0]/o[0]+n.center[0],i[1]/o[1]+n.center[1]]}},{key:"clientPosToProjPos",value:function(e,t,n){var r=this.generateTranslateAndScale(n),a=b()(r,2),o=a[0],i=a[1],u=[2*(e[0]-t.x)/t.width-1,1-2*(e[1]-t.y)/t.height];return[u[0]/i[0]-o[0],u[1]/i[1]-o[1]]}},{key:"projPosToClientPos",value:function(e,t,n){var r=this.generateTranslateAndScale(n),a=b()(r,2),o=a[0],i=a[1],u=[(e[0]+o[0])*i[0],(e[1]+o[1])*i[1]];return[(u[0]+1)/2*t.width+t.x,(1-u[1])/2*t.height+t.y]}},{key:"generateTranslateAndScale",value:function(e){var t=e.min,n=e.max,r=e.size,a=e.center,o=e.scale,i=n[0]-t[0],u=n[1]-t[1];return i/r[0]>u/r[1]?[[-t[0]-i/2-a[0],-t[1]-u/2-a[1]],[2/i*o,r[0]/r[1]*-2/i*o],[1,-r[0]/r[1]]]:[[-t[0]-i/2-a[0],-t[1]-u/2-a[1]],[r[1]/r[0]*2/u*o,-2/u*o],[r[1]/r[0],-1]]}},{key:"createShaderProgram",value:function(e,t,n){var r=e.createShader(e.VERTEX_SHADER);e.shaderSource(r,t),e.compileShader(r);var a=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(a,n),e.compileShader(a);var o=e.createProgram();return e.attachShader(o,r),e.attachShader(o,a),e.linkProgram(o),o}},{key:"initForContext",value:function(e,t,n){var r,a=this.createShaderProgram(t,"\nattribute vec2 aVertexPosition;\n\nuniform vec2 uTranslate;\nuniform vec2 uScale;\n\nvoid main() {\n    gl_Position = vec4((aVertexPosition + uTranslate) * uScale, 0.0, 1.0);\n}\n","\n#ifdef GL_ES\n    precision highp float;\n#endif\n    \nuniform vec3 uFillColor;\n\nvoid main() {\n    gl_FragColor = vec4(uFillColor, 1.0);\n}\n"),o=t.getAttribLocation(a,"aVertexPosition"),i=t.getUniformLocation(a,"uTranslate"),u=t.getUniformLocation(a,"uScale"),l=t.getUniformLocation(a,"uFillColor"),s=this.createShaderProgram(t,"\nattribute vec2 aVertexPosition;\nattribute vec2 aVertexNormal;\n\nuniform vec2 uTranslate;\nuniform vec2 uScale;\nuniform vec2 uStrokeScale;\nuniform float uWidth;\n\nvoid main() {\n    gl_Position = vec4(\n        (aVertexPosition + uTranslate) * uScale + normalize(aVertexNormal) * uWidth * uStrokeScale,\n        0.0, 1.0);\n}\n","\n#ifdef GL_ES\n    precision highp float;\n#endif\n\nuniform vec3 uStrokeColor;\n\nvoid main() {\n    gl_FragColor = vec4(uStrokeColor, 1.0);\n}\n"),f=t.getAttribLocation(s,"aVertexPosition"),c=t.getAttribLocation(s,"aVertexNormal"),h=t.getUniformLocation(s,"uTranslate"),v=t.getUniformLocation(s,"uScale"),x=t.getUniformLocation(s,"uStrokeScale"),d=t.getUniformLocation(s,"uWidth"),p=t.getUniformLocation(s,"uStrokeColor"),m=M(n);try{for(m.s();!(r=m.n()).done;){var g=r.value.triangles,y=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,y),t.bufferData(t.ARRAY_BUFFER,g.vertices,t.STATIC_DRAW);var _=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,_),t.bufferData(t.ELEMENT_ARRAY_BUFFER,g.triangles,t.STATIC_DRAW);var b=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,b),t.bufferData(t.ARRAY_BUFFER,g.outline_triangles,t.STATIC_DRAW);var P=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,P),t.bufferData(t.ARRAY_BUFFER,g.outline_normals,t.STATIC_DRAW),g.gl_position_buffer=y,g.gl_index_buffer=_,g.gl_outline_position_buffer=b,g.gl_outline_normal_buffer=P}}catch(e){m.e(e)}finally{m.f()}this.webgl_data={canvas:e,context:t,fill_data:{shader_program:a,position_attribute:o,translate_uniform:i,scale_uniform:u,color_uniform:l},stroke_data:{shader_program:s,position_attribute:f,normal_attribute:c,translate_uniform:h,scale_uniform:v,scale2_uniform:x,width_uniform:d,color_uniform:p}}}},{key:"deinitResources",value:function(e){var t;if(null!==(t=this.webgl_data)&&void 0!==t&&t.context){var n,r=this.webgl_data.context,a=M(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;r.deleteBuffer(o.gl_position_buffer),r.deleteBuffer(o.gl_index_buffer),r.deleteBuffer(o.gl_outline_position_buffer),r.deleteBuffer(o.gl_outline_normal_buffer)}}catch(e){a.e(e)}finally{a.f()}r.getAttachedShaders(this.webgl_data.fill_data.shader_program).forEach((function(e){r.deleteShader(e)})),r.deleteProgram(this.webgl_data.fill_data.shader_program),r.getAttachedShaders(this.webgl_data.stroke_data.shader_program).forEach((function(e){r.deleteShader(e)})),r.deleteProgram(this.webgl_data.stroke_data.shader_program)}}},{key:"renderMapInContext",value:function(e,t){var n=this.webgl_data.context,r=this.webgl_data.fill_data,a=this.webgl_data.stroke_data,o=this.generateTranslateAndScale(t),i=b()(o,3),u=i[0],l=i[1],s=i[2];n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT);for(var f=0;f<e.length;f++){var c=e[f],h=c.triangles;n.useProgram(a.shader_program),n.uniform2fv(a.translate_uniform,u),n.uniform2fv(a.scale_uniform,l),n.uniform2fv(a.scale2_uniform,s),n.uniform1f(a.width_uniform,.005),n.uniform3fv(a.color_uniform,[.271,.302,.38]),n.bindBuffer(n.ARRAY_BUFFER,h.gl_outline_normal_buffer),n.vertexAttribPointer(a.normal_attribute,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(a.normal_attribute),n.bindBuffer(n.ARRAY_BUFFER,h.gl_outline_position_buffer),n.vertexAttribPointer(a.position_attribute,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(a.position_attribute),n.drawArrays(n.TRIANGLES,0,h.outline_triangles.length/2),n.useProgram(r.shader_program),n.uniform2fv(r.translate_uniform,u),n.uniform2fv(r.scale_uniform,l),c.id===t.hover?n.uniform3fv(r.color_uniform,c.color.map((function(e){return.8*e}))):n.uniform3fv(r.color_uniform,c.color),n.bindBuffer(n.ARRAY_BUFFER,h.gl_position_buffer),n.vertexAttribPointer(r.position_attribute,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(r.position_attribute),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,h.gl_index_buffer),n.drawElements(n.TRIANGLES,h.triangles.length,n.UNSIGNED_SHORT,0)}}}]),e}(),T=n(35),w=n.n(T),E=n(30),I=n.n(E);function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var a=p()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return x()(this,n)}}var S,B,k=function(e){h()(n,e);var t=F(n);function n(){return l()(this,n),t.apply(this,arguments)}return f()(n,[{key:"projection",value:function(e){return w()(e)}},{key:"applyProjection",value:function(e){}},{key:"clientPosToSomePos",value:function(e,t,n){var r=this.generateScale(n),a=[(2*(e[0]-t.x)/t.width-1)/r[0],(1-2*(e[1]-t.y)/t.height)/r[1],0];if(a[2]=1-a[0]*a[0]-a[1]*a[1],a[2]<0){var o=Math.sqrt(a[0]*a[0]+a[1]*a[1]);a[0]/=o,a[1]/=o,a[2]=0}else a[2]=Math.sqrt(a[2]);var i=this.mat3VecMul(this.generateTransform(n),a);return[Math.atan2(i[0],i[2]),Math.atan2(i[1],Math.sqrt(i[0]*i[0]+i[2]*i[2]))]}},{key:"clientPosToMapPos",value:function(e,t,n){for(var r=n.center,a=this.clientPosToSomePos(e,t,n);a[0]<r[0]-Math.PI;)a[0]+=2*Math.PI;for(;a[0]>r[0]+Math.PI;)a[0]-=2*Math.PI;for(;a[1]<r[1]-Math.PI;)a[1]+=2*Math.PI;for(;a[1]>r[1]+Math.PI;)a[1]-=2*Math.PI;return a}},{key:"clientPosToProjPos",value:function(e,t,n){return this.normalizePosition(this.clientPosToSomePos(e,t,n))}},{key:"projPosToClientPos",value:function(e,t,n){var r=[Math.cos(e[1])*Math.sin(e[0]),Math.sin(e[1]),Math.cos(e[1])*Math.cos(e[0])],a=this.mat3VecMul(this.generateInverseTransform(n),r);if(a[2]<0){var o=Math.sqrt(a[0]*a[0]+a[1]*a[1]);a[0]/=o,a[1]/=o,a[2]=0}var i=this.generateScale(n);return[(a[0]*i[0]+1)/2*t.width+t.x,(1-a[1]*i[1])/2*t.height+t.y]}},{key:"generateScale",value:function(e){var t=e.size,n=e.scale;return t[0]<t[1]?[n,t[0]/t[1]*n]:[t[1]/t[0]*n,n]}},{key:"mat3Mul",value:function(e,t){for(var n=[0,0,0,0,0,0,0,0,0],r=0;r<3;r++)for(var a=0;a<3;a++)for(var o=0;o<3;o++)n[3*r+a]+=e[3*r+o]*t[3*o+a];return n}},{key:"mat3VecMul",value:function(e,t){for(var n=[0,0,0],r=0;r<3;r++)for(var a=0;a<3;a++)n[r]+=e[3*a+r]*t[a];return n}},{key:"mat3Rotation",value:function(e,t){var n=[0,0,0,0,0,0,0,0,0];return n[3*e+e]=1,n[(e+1)%3*3+(e+1)%3]=Math.cos(t),n[(e+2)%3*3+(e+1)%3]=Math.sin(t),n[(e+1)%3*3+(e+2)%3]=-Math.sin(t),n[(e+2)%3*3+(e+2)%3]=Math.cos(t),n}},{key:"generateTransform",value:function(e){var t=e.center;return this.mat3Mul(this.mat3Rotation(0,t[1]),this.mat3Rotation(1,-t[0]))}},{key:"generateInverseTransform",value:function(e){var t=e.center;return this.mat3Mul(this.mat3Rotation(1,t[0]),this.mat3Rotation(0,-t[1]))}},{key:"normalizePosition",value:function(e){var t=b()(e,2),n=t[0],r=t[1];return r=(r+Math.PI)%(2*Math.PI),(r=(2*Math.PI+r)%(2*Math.PI)-Math.PI)<-Math.PI/2?(n+=Math.PI,r=Math.abs(-Math.PI/2-r)-Math.PI/2):r>Math.PI/2&&(n+=Math.PI,r=Math.PI/2-Math.abs(r-Math.PI/2)),n=(n+Math.PI)%(2*Math.PI),[(n=(2*Math.PI+n)%(2*Math.PI))-Math.PI,r]}},{key:"generateTexMinMax",value:function(e){var t,n=e.center,r=this.generateScale(e),a=this.normalizePosition(n),o=b()(a,2),i=o[0],u=o[1];if(1/(r[0]*r[0])+1/(r[1]*r[1])>1)t=Math.abs(u)<.1?[[.5+i/Math.PI/2-.26,0],[.5+i/Math.PI/2+.26,1]]:u<0?[[0,0],[1,1+u/Math.PI]]:[[0,u/Math.PI],[1,1]];else if(.5-Math.abs(u)/Math.PI<Math.max(.05,.5/r[1]))t=u<0?[[0,0],[1,1+u/Math.PI]]:[[0,u/Math.PI],[1,1]];else{var l=Math.min(.25,.25*(1+(Math.abs(u)/Math.PI>.4?3:1)*Math.abs(u))/r[0]),s=Math.min(.25,.25*(1+Math.abs(u))/r[1]);t=[[.5+i/Math.PI/2-l,.5+u/Math.PI-2*s],[.5+i/Math.PI/2+l,.5+u/Math.PI+2*s]]}return t[0][0]=(1+t[0][0]%1)%1,t[1][0]=(1+t[1][0]%1)%1,t[1][0]<=t[0][0]&&(t[1][0]+=1),t[0][1]=Math.min(1,Math.max(0,t[0][1])),t[1][1]=Math.min(1,Math.max(0,t[1][1])),t}},{key:"initForContext",value:function(e,t,r){I()(p()(n.prototype),"initForContext",this).call(this,e,t,r);var a=t.createTexture();t.bindTexture(t.TEXTURE_2D,a),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,4096,2048,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);var o=this.createShaderProgram(t,"\nattribute vec2 aVertexPosition;\n\nuniform vec2 uScale;\n\nvarying vec2 vPixelPos;\n\nvoid main() {\n    vPixelPos = aVertexPosition;\n    gl_Position = vec4(uScale * aVertexPosition, 0.0, 1.0);\n}\n\n","\n#ifdef GL_ES\n    precision highp float;\n#endif\n\n#define PI 3.1415926538\n\nuniform sampler2D uSampler;\nuniform vec2 uTexMin;\nuniform vec2 uTexMax;\nuniform mat3 uTransform;\nuniform float uScaleZ;\n\nvarying vec2 vPixelPos;\n\nfloat fmod(float a, float b) {\n    return a - (b * floor(a / b));\n}\n\nvec2 normalizePosition(vec2 pos) {\n    pos.y = fmod(pos.y + PI, 2.0 * PI);\n    pos.y = fmod(2.0 * PI + pos.y, 2.0 * PI) - PI;\n    if (pos.y < -PI / 2.0) {\n        pos.x += PI;\n        pos.y = abs(-PI / 2.0 - pos.y) - PI / 2.0;\n    } else if (pos.y > PI / 2.0) {\n        pos.x += PI;\n        pos.y = PI / 2.0 - abs(pos.y - PI / 2.0);\n    }\n    pos.x = fmod(pos.x + PI, 2.0 * PI);\n    pos.x = fmod(2.0 * PI + pos.x, 2.0 * PI);\n    return vec2(pos.x - PI, pos.y);\n}\n\nvec3 spherePosition() {\n    vec3 pos = vec3(vPixelPos, 0.0);\n    pos.z = 1.0 - pos.x*pos.x - pos.y*pos.y;\n    if (pos.z < 0.0) {\n        float dist = sqrt(pos.x*pos.x + pos.y*pos.y);\n        pos.x /= dist;\n        pos.y /= dist;\n        pos.z = 0.0;\n    } else {\n        pos.z = sqrt(pos.z);\n    }\n    return pos;\n}\n\nvec2 texPosition(vec3 pos) {\n    pos = uTransform * pos;\n    vec2 coord = vec2(\n        atan(pos.x, pos.z),\n        atan(pos.y, sqrt(pos.x*pos.x + pos.z*pos.z))\n    );\n    vec2 lonlat = normalizePosition(coord);\n    return vec2((lonlat.x + PI) / (2.0 * PI), (lonlat.y + PI / 2.0) / PI);\n}\n\nfloat computeLight(vec3 pos, bool water) {\n    vec3 light = normalize(vec3(-1.0, 1.0, 3.0));\n    float c = max(0.0, dot(light, pos));\n    float a = max(0.0, dot(vec3(0.0, 0.0, 1.0), reflect(-light, pos)));\n    a *= a;\n    if (water) {\n        return c * 0.7 + a * 0.1 + 0.2;\n    } else {\n        return c * 0.5 + a * 0.3 + 0.2;\n    }\n}\n\nvec3 waterColor(vec3 pos) {\n    return vec3(0.0, 0.2, 0.4);\n}\n\nvoid main() {\n    bool water = false;\n    vec3 pos = spherePosition();\n    float dist = vPixelPos.x * vPixelPos.x + vPixelPos.y * vPixelPos.y;\n    float edge = (dist - 1.0) * (dist - 1.0);\n    vec2 texCoord = texPosition(pos);\n    if (uTexMin.x <= 1.0 + texCoord.x && uTexMax.x >= 1.0 + texCoord.x) {\n        vec2 texPos = vec2(\n            (texCoord.x + 1.0 - uTexMin.x) / (uTexMax.x - uTexMin.x),\n            (texCoord.y - uTexMin.y) / (uTexMax.y - uTexMin.y)\n        );\n        gl_FragColor = texture2D(uSampler, texPos);\n    } else {\n        vec2 texPos = vec2(\n            (texCoord.x - uTexMin.x) / (uTexMax.x - uTexMin.x),\n            (texCoord.y - uTexMin.y) / (uTexMax.y - uTexMin.y)\n        );\n        gl_FragColor = texture2D(uSampler, texPos);\n    }\n    if (length(gl_FragColor) == 0.0) {\n        gl_FragColor = vec4(waterColor(pos), 1.0);\n        water = true;\n    }\n    if (dist >= 1.0) {\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n    }\n    float f = 0.75 * exp(-1.0e4 * edge);\n    gl_FragColor = (1.0 - f) * gl_FragColor + f * vec4(0.5, 0.75, 1.0, 1.0);\n    if (dist < 1.0) {\n        float f = 0.2 * exp(-1.0 / (2.0 - pos.z) * uScaleZ) + 0.2 * (1.0 - pos.z);\n        gl_FragColor = (1.0 - f) * gl_FragColor + f * vec4(0.0, 0.75, 1.0, 1.0);\n    }\n    gl_FragColor.xyz = computeLight(pos, water) * gl_FragColor.xyz;\n}\n\n"),i=t.getAttribLocation(o,"aVertexPosition"),u=t.getUniformLocation(o,"uScale"),l=t.getUniformLocation(o,"uScaleZ"),s=t.getUniformLocation(o,"uSampler"),f=t.getUniformLocation(o,"uTexMin"),c=t.getUniformLocation(o,"uTexMax"),h=t.getUniformLocation(o,"uTransform"),v=new Float32Array(8);v[0]=-2,v[1]=2,v[2]=2,v[3]=2,v[4]=2,v[5]=-2,v[6]=-2,v[7]=-2;var x=new Uint16Array(6);x[0]=0,x[1]=1,x[2]=2,x[3]=2,x[4]=3,x[5]=0;var d=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,d),t.bufferData(t.ARRAY_BUFFER,v,t.STATIC_DRAW);var m=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,m),t.bufferData(t.ELEMENT_ARRAY_BUFFER,x,t.STATIC_DRAW),this.webgl_data.texture=a,this.webgl_data.earth_data={shader_program:o,position_attribute:i,scale_uniform:u,scale2_uniform:l,sampler_uniform:s,texmin_uniform:f,texmax_uniform:c,transform_uniform:h,vertices:v,triangles:x,gl_position_buffer:d,gl_index_buffer:m}}},{key:"deinitResources",value:function(e){var t;if(null!==(t=this.webgl_data)&&void 0!==t&&t.context){var r=this.webgl_data.context;r.deleteTexture(this.webgl_data.texture),r.deleteBuffer(this.webgl_data.earth_data.gl_position_buffer),r.deleteBuffer(this.webgl_data.earth_data.gl_index_buffer),r.getAttachedShaders(this.webgl_data.earth_data.shader_program).forEach((function(e){r.deleteShader(e)})),r.deleteProgram(this.webgl_data.earth_data.shader_program)}I()(p()(n.prototype),"deinitResources",this).call(this,e)}},{key:"renderToTexture",value:function(e,t,n,r){var a=this.webgl_data.context,o=this.webgl_data.fill_data,i=this.webgl_data.stroke_data,u=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,u);var l=a.COLOR_ATTACHMENT0;a.framebufferTexture2D(a.FRAMEBUFFER,l,a.TEXTURE_2D,this.webgl_data.texture,0),a.viewport(0,0,4096,2048);var s=[2*Math.PI*(.5-(n[0]+r[0])/2),Math.PI*(.5-(n[1]+r[1])/2)],f=[1/(r[0]-n[0])/Math.PI,2/(r[1]-n[1])/Math.PI],c=[.5/(r[0]-n[0])/t.scale,.5/(r[1]-n[1])/t.scale];a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT);for(var h=0;h<=1;h++){for(var v=0;v<e.length;v++){var x=e[v],d=x.triangles;(d.min[0]+s[0])*f[0]<=1&&(d.max[0]+s[0])*f[0]>=-1&&(d.min[1]+s[1])*f[1]<=1&&(d.max[1]+s[1])*f[1]>=-1&&(a.useProgram(i.shader_program),a.uniform2fv(i.translate_uniform,s),a.uniform2fv(i.scale_uniform,f),a.uniform2fv(i.scale2_uniform,c),a.uniform1f(i.width_uniform,.005),a.uniform3fv(i.color_uniform,[.271,.302,.38]),a.bindBuffer(a.ARRAY_BUFFER,d.gl_outline_normal_buffer),a.vertexAttribPointer(i.normal_attribute,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(i.normal_attribute),a.bindBuffer(a.ARRAY_BUFFER,d.gl_outline_position_buffer),a.vertexAttribPointer(i.position_attribute,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(i.position_attribute),a.drawArrays(a.TRIANGLES,0,d.outline_triangles.length/2),a.useProgram(o.shader_program),a.uniform2fv(o.translate_uniform,s),a.uniform2fv(o.scale_uniform,f),x.id===t.hover?a.uniform3fv(o.color_uniform,x.color.map((function(e){return.8*e}))):a.uniform3fv(o.color_uniform,x.color),a.bindBuffer(a.ARRAY_BUFFER,d.gl_position_buffer),a.vertexAttribPointer(o.position_attribute,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(o.position_attribute),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,d.gl_index_buffer),a.drawElements(a.TRIANGLES,d.triangles.length,a.UNSIGNED_SHORT,0))}s[0]+=2*Math.PI}a.viewport(0,0,this.webgl_data.canvas.clientWidth,this.webgl_data.canvas.clientHeight),a.bindFramebuffer(a.FRAMEBUFFER,null)}},{key:"renderMapInContext",value:function(e,t){var n=this.webgl_data.context,r=this.webgl_data.earth_data,a=this.generateTexMinMax(t),o=b()(a,2),i=o[0],u=o[1];this.renderToTexture(e,t,i,u),n.clearColor(0,0,0,0),n.clearDepth(1),n.clear(n.COLOR_BUFFER_BIT),n.useProgram(r.shader_program),n.uniform2fv(r.scale_uniform,this.generateScale(t)),n.uniform2fv(r.scale_uniform,this.generateScale(t)),n.uniform1fv(r.scale2_uniform,[t.scale]),n.uniform1i(r.sampler_uniform,0),n.uniform2fv(r.texmin_uniform,i),n.uniform2fv(r.texmax_uniform,u),n.uniformMatrix3fv(r.transform_uniform,!1,this.generateTransform(t)),n.bindBuffer(n.ARRAY_BUFFER,r.gl_position_buffer),n.vertexAttribPointer(r.position_attribute,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(r.position_attribute),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r.gl_index_buffer),n.drawElements(n.TRIANGLES,r.triangles.length,n.UNSIGNED_SHORT,0)}}]),n}(A);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){u=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(u)throw o}}}}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var a=p()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return x()(this,n)}}var j={},D=function(e){h()(n,e);var t=L(n);function n(){var e;return l()(this,n),(e=t.call(this)).renderer=e.newRenderer(),e.state={center:[0,0],scale:1,min:[0,0],max:[0,0],size:[0,0],hover:null},e}return f()(n,[{key:"newRenderer",value:function(){return new A}},{key:"center",get:function(){return this.state.center}},{key:"scale",get:function(){return this.state.scale}},{key:"setCenterAndScale",value:function(e,t){this.state.center=e,this.state.scale=t}},{key:"clientPosToMapPos",value:function(e){var t=this.shadowRoot.getElementById("map").getBoundingClientRect();return this.renderer.clientPosToMapPos(e,t,this.state)}},{key:"clientPosToProjPos",value:function(e){var t=this.shadowRoot.getElementById("map").getBoundingClientRect();return this.renderer.clientPosToProjPos(e,t,this.state)}},{key:"projPosToClientPos",value:function(e){var t=this.shadowRoot.getElementById("map").getBoundingClientRect();return this.renderer.projPosToClientPos(e,t,this.state)}},{key:"handleMouseMove",value:function(e){var t,n=this.clientPosToProjPos([e.clientX,e.clientY]),r=U(this.locations);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(a.triangles.min[0]<=n[0]&&a.triangles.min[1]<=n[1]&&a.triangles.max[0]>=n[0]&&a.triangles.max[1]>=n[1]){var o,i=U(a.triangles.polygons);try{for(i.s();!(o=i.n()).done;){var u=o.value;if(u.min[0]<=n[0]&&u.min[1]<=n[1]&&u.max[0]>=n[0]&&u.max[1]>=n[1])for(var l=0;l<u.triangles.length;l+=3){var s=[u.vertices[2*u.triangles[l]],u.vertices[2*u.triangles[l]+1]],f=[u.vertices[2*u.triangles[l+1]],u.vertices[2*u.triangles[l+1]+1]],c=[u.vertices[2*u.triangles[l+2]],u.vertices[2*u.triangles[l+2]+1]];function h(e,t,n){return(e[0]-n[0])*(t[1]-n[1])-(t[0]-n[0])*(e[1]-n[1])}var v=h(n,s,f),x=h(n,f,c),d=h(n,c,s);if(!(v<0||x<0||d<0)||!(v>0||x>0||d>0)){this.state.hover=a.id;var p=new Event("hover");return p.location=a,p.position=this.projPosToClientPos([(u.min[0]+u.max[0])/2,(u.min[1]+u.max[1])/2]),void this.dispatchEvent(p)}}}}catch(e){i.e(e)}finally{i.f()}}}}catch(e){r.e(e)}finally{r.f()}this.handleMouseOut()}},{key:"handleMouseOut",value:function(){this.state.hover=null;var e=new Event("hover");e.location=null,e.position=null,this.dispatchEvent(e)}},{key:"handleTouchStart",value:function(e){1===e.touches.length?this.handleMouseMove({clientX:e.touches[0].clientX,clientY:e.touches[0].clientY}):this.handleMouseOut(e)}},{key:"renderMapInCanvas",value:function(){this.last&&this.last.center==this.state.center&&this.last.scale==this.state.scale&&this.last.hover==this.state.hover&&this.last.size==this.state.size||(this.renderer.renderMapInContext(this.locations,this.state),this.last=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.state)),window.requestAnimationFrame(this.renderMapInCanvas.bind(this))}},{key:"firstUpdated",value:function(){var e=this,t=this.shadowRoot.getElementById("map"),n=t.getContext("webgl")||t.getContext("experimental-webgl"),r=function(){t.width=t.clientWidth,t.height=t.clientHeight,n.viewport(0,0,t.width,t.height),e.state.size=[t.width,t.height]};window.addEventListener("resize",r),r(),this.renderer.initForContext(t,n,this.locations),this.renderMapInCanvas()}},{key:"updated",value:function(){this.last=null}},{key:"disconnectedCallback",value:function(){this.renderer.deinitResources(this.locations)}},{key:"generateTriangles",value:function(e){var t,n=[],r=0,a=0,o=0,i=U(e.coords);try{for(i.s();!(t=i.n()).done;){var u,l=t.value,s=U(l);try{for(s.s();!(u=s.n()).done;){o+=u.value.length}}catch(e){s.e(e)}finally{s.f()}var f=y.a.flatten(l);this.renderer.applyProjection(f.vertices);var c=y()(f.vertices,f.holes,f.dimensions);r+=f.vertices.length,a+=c.length,n.push({vertices:new Float32Array(f.vertices),triangles:new Uint16Array(c),min:l.flat().map(this.renderer.projection).reduce((function(e,t){return[Math.min(e[0],t[0]),Math.min(e[1],t[1])]})),max:l.flat().map(this.renderer.projection).reduce((function(e,t){return[Math.max(e[0],t[0]),Math.max(e[1],t[1])]}))})}}catch(e){i.e(e)}finally{i.f()}var h=new Float32Array(r),v=new Uint16Array(a);r=0,a=0;for(var x=0,d=n;x<d.length;x++){var p=d[x];h.set(p.vertices,r);for(var m=0;m<p.triangles.length;m++)v[a+m]=r/2+p.triangles[m];r+=p.vertices.length,a+=p.triangles.length}var g=new Float32Array(24*o),_=new Float32Array(24*o);o=0;var b,P=U(e.coords);try{for(P.s();!(b=P.n()).done;){var M,R=U(b.value);try{for(R.s();!(M=R.n()).done;){for(var A=M.value.map(this.renderer.projection),T=0;T<A.length;T++){var w=A[T],E=A[(A.length+T-1)%A.length],I=A[(T+1)%A.length],F=[w[0]-E[0],w[1]-E[1]],S=[I[0]-w[0],I[1]-w[1]],B=24*o+24*T;g.set([w[0],w[1],w[0],w[1],I[0],I[1],w[0],w[1],I[0],I[1],I[0],I[1],w[0],w[1],w[0],w[1],w[0],w[1],w[0],w[1],w[0],w[1],w[0],w[1]],B),_.set([S[1],-S[0],-S[1],S[0],S[1],-S[0],-S[1],S[0],-S[1],S[0],S[1],-S[0],-F[1],F[0],F[1],-F[0],-S[1],S[0],-F[1],F[0],F[1],-F[0],S[1],-S[0]],B)}o+=A.length}}catch(e){R.e(e)}finally{R.f()}}}catch(e){P.e(e)}finally{P.f()}return{polygons:n,vertices:h,triangles:v,outline_triangles:g,outline_normals:_,min:n.map((function(e){return e.min})).reduce((function(e,t){return[Math.min(e[0],t[0]),Math.min(e[1],t[1])]})),max:n.map((function(e){return e.max})).reduce((function(e,t){return[Math.max(e[0],t[0]),Math.max(e[1],t[1])]}))}}},{key:"buildRenderData",value:function(){var e=this;this.locations.forEach((function(t){t.color=t.color.map((function(e){return e/255})),t&&(j[t.id]||(j[t.id]=e.generateTriangles(t)),t.triangles=j[t.id])})),this.state.min=this.locations.map((function(e){return e.triangles.min})).reduce((function(e,t){return[Math.min(e[0],t[0]),Math.min(e[1],t[1])]})),this.state.max=this.locations.map((function(e){return e.triangles.max})).reduce((function(e,t){return[Math.max(e[0],t[0]),Math.max(e[1],t[1])]}))}},{key:"render",value:function(){return this.buildRenderData(),Object(m.c)(S||(S=a()(['\n            <canvas\n                id="map"\n                @mousemove="','"\n                @wheel="','"\n                @mouseout="','"\n                @touchstart="','"\n                @touchmove="','"\n            >\n            </canvas>\n        '])),this.handleMouseMove,this.handleMouseMove,this.handleMouseOut,this.handleTouchStart,this.handleTouchStart)}}],[{key:"properties",get:function(){return{locations:{attribute:!0},render3d:{type:Boolean}}}},{key:"styles",get:function(){return Object(m.b)(B||(B=a()(["\n            :host {\n                width: 100%;\n                height: 100%;\n                position: relative;\n                display: block;\n            }\n            #map {\n                width: 100%;\n                height: 100%;\n                max-width: 100%;\n                max-height: 100%;\n                display: block;\n                position: absolute;\n            }\n        "])))}}]),n}(m.a);customElements.define("map-backend",D);var z=function(e){h()(n,e);var t=L(n);function n(){return l()(this,n),t.apply(this,arguments)}return f()(n,[{key:"newRenderer",value:function(){return new k}}]),n}(D);customElements.define("map-backend-3d",z)}}]);