"use strict";(self.webpackChunkgeo_draw=self.webpackChunkgeo_draw||[]).push([[968],{971:(t,n,o)=>{o.r(n);var e,a,r,i,c=o(168),s=o(982),u=o(671),l=o(144),h=o(340),d=o(215),p=o(120),m=o(392),f=o(959),v=o(293);var g=function(t){(0,h.Z)(y,t);var n,o,g=(n=y,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=(0,p.Z)(n);if(o){var a=(0,p.Z)(this).constructor;t=Reflect.construct(e,arguments,a)}else t=e.apply(this,arguments);return(0,d.Z)(this,t)});function y(){var t;return(0,u.Z)(this,y),(t=g.call(this)).zoom_scale=1,t.zoom_center=[0,0],t}return(0,l.Z)(y,[{key:"center",get:function(){return this.zoom_center}},{key:"scale",get:function(){return this.zoom_scale}},{key:"setCenterAndScale",value:function(t,n){this.zoom_center=t,this.zoom_scale=n,this.shadowRoot.getElementById("map").style.transform="scale(".concat(this.zoom_scale,") translate(").concat(-this.zoom_center[0],"%,").concat(-this.zoom_center[1],"%)")}},{key:"clientPosToMapPos",value:function(t){var n=this.shadowRoot.getElementById("map").getBoundingClientRect();return[(t[0]-n.x-n.width/2)/n.width*100,(t[1]-n.y-n.height/2)/n.height*100]}},{key:"handleMouseMove",value:function(t){var n,o,e=t.target,a=e;if("path"===(null===(n=a)||void 0===n?void 0:n.tagName)&&(a=a.parentNode),null!==(o=a)&&void 0!==o&&o.location_data){var r,i=null===(r=a)||void 0===r?void 0:r.location_data,c=e.getBoundingClientRect(),s=[c.x+c.width/2,c.y+c.height/2],u=new Event("hover");u.location=i,u.position=s,this.dispatchEvent(u)}else{var l=new Event("hover");l.location=null,l.position=null,this.dispatchEvent(l)}}},{key:"handleMouseOut",value:function(){var t=new Event("hover");t.location=null,t.position=null,this.dispatchEvent(t)}},{key:"handleTouchStart",value:function(t){1===t.touches.length?this.handleMouseMove(t):this.handleMouseOut(t)}},{key:"updated",value:function(){var t=this;window.requestAnimationFrame((function n(){var o=t.shadowRoot.getElementById("map");o?window.requestAnimationFrame((function(){window.requestAnimationFrame((function(){o.style.transform="scale(".concat(t.zoom_scale,") translate(").concat(-t.zoom_center[0],"%,").concat(-t.zoom_center[1],"%)"),o.style.opacity=1}))})):window.requestAnimationFrame(n)}))}},{key:"svgPathForPolygon",value:function(t,n,o,e){for(var a=t.vertex,r=[0].concat((0,s.Z)(t.holes),[a.length/2]),i=[],c=0;c<r.length-1;c++){for(var u=[],l=[NaN,NaN],h=r[c];h<r[c+1];h++){var d=[Math.round((0,v.U)(a[2*h],n[0],n[0]+o,0,e)).toString(),Math.round((0,v.U)(a[2*h+1],n[1],n[1]+o,0,e)).toString()];d[0]==l[0]&&d[1]==l[1]||(u.push(h==r[c]?" M":" L"),u.push(d[0]+","+d[1]),l=d)}i.push.apply(i,u),i.push(" z ")}return i.join("")}},{key:"render",value:function(){var t=this;this.locations.forEach((function(t){!t||t.proj_min&&t.proj_max||(t.proj_min=t.raw.proj_min,t.proj_max=t.raw.proj_max)}));var n=this.locations.filter((function(t){return t})).map((function(t){return t.proj_min})).reduce((function(t,n){return[Math.min(t[0],n[0]),Math.min(t[1],n[1])]})),o=this.locations.filter((function(t){return t})).map((function(t){return t.proj_max})).reduce((function(t,n){return[Math.max(t[0],n[0]),Math.max(t[1],n[1])]})),i=Math.max(o[0]-n[0],o[1]-n[1]),u=5*Math.max(window.innerWidth,window.innerHeight);return this.locations.forEach((function(o){o&&(o.proj_polygons||(o.proj_polygons=(0,s.Z)(Array(o.raw.count_polygons()).keys()).map((function(t){return o.raw.get_proj_polygon(t)}))),o.svg=o.proj_polygons.map((function(o){return(0,m.YP)(e||(e=(0,c.Z)(['<path d="','"/>'])),t.svgPathForPolygon(o,n,i,u))})))})),(0,m.dy)(a||(a=(0,c.Z)(['\n            <svg\n                id="map"\n                viewBox="','"\n                @mousemove="','"\n                @wheel="','"\n                @mouseout="','"\n                @touchstart="','"\n                @touchmove="','"\n            >\n                ',"\n            </svg>\n        "])),Math.round((0,v.U)(n[0],n[0],n[0]+i,0,u))+" "+Math.round((0,v.U)(n[1],n[1],n[1]+i,0,u))+" "+Math.round((0,v.U)(o[0],n[0],n[0]+i,0,u))+" "+Math.round((0,v.U)(o[1],n[1],n[1]+i,0,u)),this.handleMouseMove,this.handleMouseMove,this.handleMouseOut,this.handleTouchStart,this.handleTouchStart,this.locations.map((function(t){return(0,m.YP)(r||(r=(0,c.Z)(['\n                    <g\n                        class="geometry"\n                        style="','"\n                        .location_data="','"\n                    >\n                        ',"\n                    </g>\n                "])),(0,f.V)({fill:"rgb(".concat(t.color[0],",").concat(t.color[1],",").concat(t.color[2],")")}),t,null==t?void 0:t.svg)})))}}],[{key:"properties",get:function(){return{locations:{type:Array}}}},{key:"styles",get:function(){return(0,m.iv)(i||(i=(0,c.Z)(["\n            :host {\n                width: 100%;\n                height: 100%;\n                position: relative;\n                display: block;\n            }\n            #map {\n                width: 100%;\n                height: 100%;\n                max-width: 100%;\n                max-height: 100%;\n                transform: scale(5);\n                opacity: 0.001;\n                will-change: transform, opacity;\n                stroke: var(--background-darkish);\n                stroke-width: 0.125%;\n                stroke-linejoin: round;\n                paint-order: stroke fill;\n                display: block;\n                position: absolute;\n            }\n            svg#map g:hover {\n                fill-opacity: 0.75;\n            }\n        "])))}}]),y}(m.oi);customElements.define("map-backend",g)}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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eUJ0QixFQUFJc0IsTUFBTSxHQUFuQyxZQUF5Q3RCLEVBQUlzQixNQUFNLEdBQW5ELE9BRVV0QixFQUVoQkEsTUFBQUEsT0FSVyxFQVFYQSxFQUFLZ0IsWSx1QkEvTDNCLFdBQ0ksTUFBTyxDQUNIbEIsVUFBVyxDQUFFeUIsS0FBTVgsVSxrQkFJM0IsV0FDSSxPQUFPWSxFQUFBQSxFQUFBQSxJQUFQLGl6QixFQVRGckYsQ0FBc0JzRixFQUFBQSxJQTBNNUJDLGVBQWVDLE9BQU8sY0FBZXhGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZ2VvLWRyYXcvLi9zcmMvbWFwL21hcC1iYWNrZW5kLXN2Zy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcbmltcG9ydCB7IExpdEVsZW1lbnQsIGh0bWwsIHN2ZywgY3NzIH0gZnJvbSAnbGl0JztcbmltcG9ydCB7IHN0eWxlTWFwIH0gZnJvbSAnbGl0L2RpcmVjdGl2ZXMvc3R5bGUtbWFwLmpzJztcblxuaW1wb3J0IHsgbWFwIH0gZnJvbSAnLi4vdXRpbCc7XG5cbmNsYXNzIE1hcEJhY2tlbmRTdmcgZXh0ZW5kcyBMaXRFbGVtZW50IHtcblxuICAgIHN0YXRpYyBnZXQgcHJvcGVydGllcygpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGxvY2F0aW9uczogeyB0eXBlOiBBcnJheSB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzdGF0aWMgZ2V0IHN0eWxlcygpIHtcbiAgICAgICAgcmV0dXJuIGNzc2BcbiAgICAgICAgICAgIDpob3N0IHtcbiAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDEwMCU7XG4gICAgICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICAgICAgICAgICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgI21hcCB7XG4gICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgICAgICAgICAgIG1heC13aWR0aDogMTAwJTtcbiAgICAgICAgICAgICAgICBtYXgtaGVpZ2h0OiAxMDAlO1xuICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogc2NhbGUoNSk7XG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMC4wMDE7XG4gICAgICAgICAgICAgICAgd2lsbC1jaGFuZ2U6IHRyYW5zZm9ybSwgb3BhY2l0eTtcbiAgICAgICAgICAgICAgICBzdHJva2U6IHZhcigtLWJhY2tncm91bmQtZGFya2lzaCk7XG4gICAgICAgICAgICAgICAgc3Ryb2tlLXdpZHRoOiAwLjEyNSU7XG4gICAgICAgICAgICAgICAgc3Ryb2tlLWxpbmVqb2luOiByb3VuZDtcbiAgICAgICAgICAgICAgICBwYWludC1vcmRlcjogc3Ryb2tlIGZpbGw7XG4gICAgICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7XG4gICAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3ZnI21hcCBnOmhvdmVyIHtcbiAgICAgICAgICAgICAgICBmaWxsLW9wYWNpdHk6IDAuNzU7XG4gICAgICAgICAgICB9XG4gICAgICAgIGA7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnpvb21fc2NhbGUgPSAxO1xuICAgICAgICB0aGlzLnpvb21fY2VudGVyID0gWzAsIDBdO1xuICAgIH1cbiAgICBcbiAgICBnZXQgY2VudGVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy56b29tX2NlbnRlcjtcbiAgICB9XG5cbiAgICBnZXQgc2NhbGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnpvb21fc2NhbGU7XG4gICAgfVxuXG4gICAgc2V0Q2VudGVyQW5kU2NhbGUoY2VudGVyLCBzY2FsZSkge1xuICAgICAgICB0aGlzLnpvb21fY2VudGVyID0gY2VudGVyO1xuICAgICAgICB0aGlzLnpvb21fc2NhbGUgPSBzY2FsZTtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMuc2hhZG93Um9vdC5nZXRFbGVtZW50QnlJZCgnbWFwJyk7XG4gICAgICAgIGVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gYHNjYWxlKCR7dGhpcy56b29tX3NjYWxlfSkgdHJhbnNsYXRlKCR7LXRoaXMuem9vbV9jZW50ZXJbMF19JSwkey10aGlzLnpvb21fY2VudGVyWzFdfSUpYDtcbiAgICB9XG4gICAgXG4gICAgY2xpZW50UG9zVG9NYXBQb3MoY2xpZW50X3Bvcykge1xuICAgICAgICBjb25zdCBtYXAgPSB0aGlzLnNoYWRvd1Jvb3QuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpO1xuICAgICAgICBjb25zdCBtYXBfcG9zID0gbWFwLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgKGNsaWVudF9wb3NbMF0gLSBtYXBfcG9zLnggLSBtYXBfcG9zLndpZHRoIC8gMikgLyBtYXBfcG9zLndpZHRoICogMTAwLFxuICAgICAgICAgICAgKGNsaWVudF9wb3NbMV0gLSBtYXBfcG9zLnkgLSBtYXBfcG9zLmhlaWdodCAvIDIpIC8gbWFwX3Bvcy5oZWlnaHQgKiAxMDAsXG4gICAgICAgIF07XG4gICAgfVxuXG4gICAgaGFuZGxlTW91c2VNb3ZlKGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IGJhc2VfZWxlbSA9IGV2ZW50LnRhcmdldDtcbiAgICAgICAgbGV0IGVsZW0gPSBiYXNlX2VsZW07XG4gICAgICAgIGlmKGVsZW0/LnRhZ05hbWUgPT09ICdwYXRoJykge1xuICAgICAgICAgICAgZWxlbSA9IGVsZW0ucGFyZW50Tm9kZTtcbiAgICAgICAgfVxuICAgICAgICBpZihlbGVtPy5sb2NhdGlvbl9kYXRhKSB7XG4gICAgICAgICAgICBjb25zdCBsb2NhdGlvbiA9IGVsZW0/LmxvY2F0aW9uX2RhdGE7XG4gICAgICAgICAgICBjb25zdCBlbGVtX3BvcyA9IGJhc2VfZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gW2VsZW1fcG9zLnggKyBlbGVtX3Bvcy53aWR0aCAvIDIsIGVsZW1fcG9zLnkgKyBlbGVtX3Bvcy5oZWlnaHQgLyAyXTtcbiAgICAgICAgICAgIGNvbnN0IG15X2V2ZW50ID0gbmV3IEV2ZW50KCdob3ZlcicpO1xuICAgICAgICAgICAgbXlfZXZlbnQubG9jYXRpb24gPSBsb2NhdGlvbjtcbiAgICAgICAgICAgIG15X2V2ZW50LnBvc2l0aW9uID0gcG9zaXRpb247XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQobXlfZXZlbnQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgbXlfZXZlbnQgPSBuZXcgRXZlbnQoJ2hvdmVyJyk7XG4gICAgICAgICAgICBteV9ldmVudC5sb2NhdGlvbiA9IG51bGw7XG4gICAgICAgICAgICBteV9ldmVudC5wb3NpdGlvbiA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQobXlfZXZlbnQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaGFuZGxlTW91c2VPdXQoKSB7XG4gICAgICAgIGNvbnN0IG15X2V2ZW50ID0gbmV3IEV2ZW50KCdob3ZlcicpO1xuICAgICAgICBteV9ldmVudC5sb2NhdGlvbiA9IG51bGw7XG4gICAgICAgIG15X2V2ZW50LnBvc2l0aW9uID0gbnVsbDtcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KG15X2V2ZW50KTtcbiAgICB9XG4gICAgXG4gICAgaGFuZGxlVG91Y2hTdGFydChldmVudCkge1xuICAgICAgICBpZihldmVudC50b3VjaGVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVNb3VzZU1vdmUoZXZlbnQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVNb3VzZU91dChldmVudCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB1cGRhdGVkKCkge1xuICAgICAgICAvLyBUaGlzIGlzIGEgc3R1cGlkIHRyaWNrIHRvIGdldCBjaHJvbWUgdG8gcmVuZGVyIGF0IGEgaGlnaGVyIHJlc29sdXRpb25cbiAgICAgICAgY29uc3QgYW5pbWF0aW9uRnJhbWVDYWxsYmFjayA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLnNoYWRvd1Jvb3QuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpO1xuICAgICAgICAgICAgaWYoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gYHNjYWxlKCR7dGhpcy56b29tX3NjYWxlfSkgdHJhbnNsYXRlKCR7LXRoaXMuem9vbV9jZW50ZXJbMF19JSwkey10aGlzLnpvb21fY2VudGVyWzFdfSUpYDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUub3BhY2l0eSA9IDE7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGlvbkZyYW1lQ2FsbGJhY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGlvbkZyYW1lQ2FsbGJhY2spO1xuICAgIH1cblxuICAgIHN2Z1BhdGhGb3JQb2x5Z29uKHBvbHksIG1pbiwgdG90YWxfZGlmZiwgbWF4X3NpemUpIHtcbiAgICAgICAgY29uc3QgdmVydGV4ID0gcG9seS52ZXJ0ZXg7XG4gICAgICAgIGNvbnN0IHN0YXJ0cyA9IFswLCAuLi5wb2x5LmhvbGVzLCB2ZXJ0ZXgubGVuZ3RoIC8gMl07XG4gICAgICAgIGNvbnN0IHJlcyA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0YXJ0cy5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IHN1YiA9IFtdO1xuICAgICAgICAgICAgY29uc3QgbGFzdCA9IFtOYU4sIE5hTl07XG4gICAgICAgICAgICBmb3IgKGxldCBqID0gc3RhcnRzW2ldOyBqIDwgc3RhcnRzW2kgKyAxXTsgaisrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29vcmRzID0gW1xuICAgICAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKG1hcCh2ZXJ0ZXhbMipqXSwgbWluWzBdLCBtaW5bMF0gKyB0b3RhbF9kaWZmLCAwLCBtYXhfc2l6ZSkpLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQobWFwKHZlcnRleFsyKmogKyAxXSwgbWluWzFdLCBtaW5bMV0gKyB0b3RhbF9kaWZmLCAwLCBtYXhfc2l6ZSkpLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICBpZiAoY29vcmRzWzBdICE9IGxhc3RbMF0gfHwgY29vcmRzWzFdICE9IGxhc3RbMV0pIHtcbiAgICAgICAgICAgICAgICAgICAgc3ViLnB1c2goaiA9PSBzdGFydHNbaV0gPyAnIE0nIDogJyBMJyk7XG4gICAgICAgICAgICAgICAgICAgIHN1Yi5wdXNoKGNvb3Jkc1swXSArICcsJyArIGNvb3Jkc1sxXSk7XG4gICAgICAgICAgICAgICAgICAgIGxhc3QgPSBjb29yZHM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzLnB1c2goLi4uc3ViKTtcbiAgICAgICAgICAgIHJlcy5wdXNoKCcgeiAnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzLmpvaW4oJycpO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgdGhpcy5sb2NhdGlvbnMuZm9yRWFjaChsb2MgPT4ge1xuICAgICAgICAgICAgaWYgKGxvYyAmJiAoIWxvYy5wcm9qX21pbiB8fCAhbG9jLnByb2pfbWF4KSkge1xuICAgICAgICAgICAgICAgIGxvYy5wcm9qX21pbiA9IGxvYy5yYXcucHJval9taW47XG4gICAgICAgICAgICAgICAgbG9jLnByb2pfbWF4ID0gbG9jLnJhdy5wcm9qX21heDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgY29uc3QgbWluID0gdGhpcy5sb2NhdGlvbnMuZmlsdGVyKGxvYyA9PiBsb2MpLm1hcChsb2MgPT4gbG9jLnByb2pfbWluKVxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoKGEsIGIpID0+IFtNYXRoLm1pbihhWzBdLCBiWzBdKSwgTWF0aC5taW4oYVsxXSwgYlsxXSldKTtcbiAgICAgICAgY29uc3QgbWF4ID0gdGhpcy5sb2NhdGlvbnMuZmlsdGVyKGxvYyA9PiBsb2MpLm1hcChsb2MgPT4gbG9jLnByb2pfbWF4KVxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoKGEsIGIpID0+IFtNYXRoLm1heChhWzBdLCBiWzBdKSwgTWF0aC5tYXgoYVsxXSwgYlsxXSldKTtcbiAgICAgICAgY29uc3QgdG90YWxfZGlmZiA9IE1hdGgubWF4KG1heFswXSAtIG1pblswXSwgbWF4WzFdIC0gbWluWzFdKTtcbiAgICAgICAgY29uc3QgbWF4X3NpemUgPSBNYXRoLm1heCh3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0KSAqIDU7XG4gICAgICAgIHRoaXMubG9jYXRpb25zLmZvckVhY2gobG9jID0+IHtcbiAgICAgICAgICAgIGlmKGxvYykge1xuICAgICAgICAgICAgICAgIGlmICghbG9jLnByb2pfcG9seWdvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9jLnByb2pfcG9seWdvbnMgPSBbLi4uQXJyYXkobG9jLnJhdy5jb3VudF9wb2x5Z29ucygpKS5rZXlzKCldXG4gICAgICAgICAgICAgICAgICAgICAgICAubWFwKGkgPT4gbG9jLnJhdy5nZXRfcHJval9wb2x5Z29uKGkpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbG9jLnN2ZyA9IGxvYy5wcm9qX3BvbHlnb25zLm1hcChwb2x5ID0+IChcbiAgICAgICAgICAgICAgICAgICAgc3ZnYDxwYXRoIGQ9XCIke3RoaXMuc3ZnUGF0aEZvclBvbHlnb24ocG9seSwgbWluLCB0b3RhbF9kaWZmLCBtYXhfc2l6ZSl9XCIvPmBcbiAgICAgICAgICAgICAgICApKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBodG1sYFxuICAgICAgICAgICAgPHN2Z1xuICAgICAgICAgICAgICAgIGlkPVwibWFwXCJcbiAgICAgICAgICAgICAgICB2aWV3Qm94PVwiJHtcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5yb3VuZChtYXAobWluWzBdLCBtaW5bMF0sIG1pblswXSArIHRvdGFsX2RpZmYsIDAsIG1heF9zaXplKSkgKyAnICcgKyBcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5yb3VuZChtYXAobWluWzFdLCBtaW5bMV0sIG1pblsxXSArIHRvdGFsX2RpZmYsIDAsIG1heF9zaXplKSkgKyAnICcgK1xuICAgICAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKG1hcChtYXhbMF0sIG1pblswXSwgbWluWzBdICsgdG90YWxfZGlmZiwgMCwgbWF4X3NpemUpKSArICcgJyArIFxuICAgICAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKG1hcChtYXhbMV0sIG1pblsxXSwgbWluWzFdICsgdG90YWxfZGlmZiwgMCwgbWF4X3NpemUpKVxuICAgICAgICAgICAgICAgIH1cIlxuICAgICAgICAgICAgICAgIEBtb3VzZW1vdmU9XCIke3RoaXMuaGFuZGxlTW91c2VNb3ZlfVwiXG4gICAgICAgICAgICAgICAgQHdoZWVsPVwiJHt0aGlzLmhhbmRsZU1vdXNlTW92ZX1cIlxuICAgICAgICAgICAgICAgIEBtb3VzZW91dD1cIiR7dGhpcy5oYW5kbGVNb3VzZU91dH1cIlxuICAgICAgICAgICAgICAgIEB0b3VjaHN0YXJ0PVwiJHt0aGlzLmhhbmRsZVRvdWNoU3RhcnR9XCJcbiAgICAgICAgICAgICAgICBAdG91Y2htb3ZlPVwiJHt0aGlzLmhhbmRsZVRvdWNoU3RhcnR9XCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAke3RoaXMubG9jYXRpb25zLm1hcCgobG9jKSA9PiAoc3ZnYFxuICAgICAgICAgICAgICAgICAgICA8Z1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M9XCJnZW9tZXRyeVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT1cIiR7c3R5bGVNYXAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGw6IGByZ2IoJHtsb2MuY29sb3JbMF19LCR7bG9jLmNvbG9yWzFdfSwke2xvYy5jb2xvclsyXX0pYCxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pfVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAubG9jYXRpb25fZGF0YT1cIiR7bG9jfVwiXG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICR7bG9jPy5zdmd9XG4gICAgICAgICAgICAgICAgICAgIDwvZz5cbiAgICAgICAgICAgICAgICBgKSl9XG4gICAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgYDtcbiAgICB9XG5cbn1cblxuY3VzdG9tRWxlbWVudHMuZGVmaW5lKCdtYXAtYmFja2VuZCcsIE1hcEJhY2tlbmRTdmcpO1xuIl0sIm5hbWVzIjpbIk1hcEJhY2tlbmRTdmciLCJ6b29tX3NjYWxlIiwiem9vbV9jZW50ZXIiLCJ0aGlzIiwiY2VudGVyIiwic2NhbGUiLCJzaGFkb3dSb290IiwiZ2V0RWxlbWVudEJ5SWQiLCJzdHlsZSIsInRyYW5zZm9ybSIsImNsaWVudF9wb3MiLCJtYXBfcG9zIiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwieCIsIndpZHRoIiwieSIsImhlaWdodCIsImV2ZW50IiwiYmFzZV9lbGVtIiwidGFyZ2V0IiwiZWxlbSIsInRhZ05hbWUiLCJwYXJlbnROb2RlIiwibG9jYXRpb25fZGF0YSIsImxvY2F0aW9uIiwiZWxlbV9wb3MiLCJwb3NpdGlvbiIsIm15X2V2ZW50IiwiRXZlbnQiLCJkaXNwYXRjaEV2ZW50IiwidG91Y2hlcyIsImxlbmd0aCIsImhhbmRsZU1vdXNlTW92ZSIsImhhbmRsZU1vdXNlT3V0Iiwid2luZG93IiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiYW5pbWF0aW9uRnJhbWVDYWxsYmFjayIsImVsZW1lbnQiLCJvcGFjaXR5IiwicG9seSIsIm1pbiIsInRvdGFsX2RpZmYiLCJtYXhfc2l6ZSIsInZlcnRleCIsInN0YXJ0cyIsImhvbGVzIiwicmVzIiwiaSIsInN1YiIsImxhc3QiLCJOYU4iLCJqIiwiY29vcmRzIiwiTWF0aCIsInJvdW5kIiwibWFwIiwidG9TdHJpbmciLCJwdXNoIiwiam9pbiIsImxvY2F0aW9ucyIsImZvckVhY2giLCJsb2MiLCJwcm9qX21pbiIsInByb2pfbWF4IiwicmF3IiwiZmlsdGVyIiwicmVkdWNlIiwiYSIsImIiLCJtYXgiLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJwcm9qX3BvbHlnb25zIiwiQXJyYXkiLCJjb3VudF9wb2x5Z29ucyIsImtleXMiLCJnZXRfcHJval9wb2x5Z29uIiwic3ZnIiwic3ZnUGF0aEZvclBvbHlnb24iLCJodG1sIiwiaGFuZGxlVG91Y2hTdGFydCIsInN0eWxlTWFwIiwiZmlsbCIsImNvbG9yIiwidHlwZSIsImNzcyIsIkxpdEVsZW1lbnQiLCJjdXN0b21FbGVtZW50cyIsImRlZmluZSJdLCJzb3VyY2VSb290IjoiIn0=