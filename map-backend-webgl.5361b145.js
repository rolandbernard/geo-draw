(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{48:function(e,t,n){"use strict";function r(e,t,n){n=n||2;var r,u,l,s,c,v,x,m=t&&t.length,_=m?t[0]*n:e.length,y=i(e,0,_,n,!0),p=[];if(!y||y.next===y.prev)return p;if(m&&(y=function(e,t,n,r){var a,u,l,s,c,v=[];for(a=0,u=t.length;a<u;a++)l=t[a]*r,s=a<u-1?t[a+1]*r:e.length,(c=i(e,l,s,r,!1))===c.next&&(c.steiner=!0),v.push(d(c));for(v.sort(f),a=0;a<v.length;a++)h(v[a],n),n=o(n,n.next);return n}(e,t,y,n)),e.length>80*n){r=l=e[0],u=s=e[1];for(var g=n;g<_;g+=n)(c=e[g])<r&&(r=c),(v=e[g+1])<u&&(u=v),c>l&&(l=c),v>s&&(s=v);x=0!==(x=Math.max(l-r,s-u))?1/x:0}return a(y,p,n,r,u,x),p}function i(e,t,n,r,i){var o,a;if(i===T(e,t,n,r)>0)for(o=t;o<n;o+=r)a=S(o,e[o],e[o+1],a);else for(o=n-r;o>=t;o-=r)a=S(o,e[o],e[o+1],a);return a&&p(a,a.next)&&(z(a),a=a.next),a}function o(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!p(r,r.next)&&0!==y(r.prev,r,r.next))r=r.next;else{if(z(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function a(e,t,n,r,i,f,h){if(e){!h&&f&&function(e,t,n,r){var i=e;do{null===i.z&&(i.z=x(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,o,a,u,l,s=1;do{for(n=e,e=null,o=null,a=0;n;){for(a++,r=n,u=0,t=0;t<s&&(u++,r=r.nextZ);t++);for(l=s;u>0||l>0&&r;)0!==u&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,u--):(i=r,r=r.nextZ,l--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;n=r}o.nextZ=null,s*=2}while(a>1)}(i)}(e,r,i,f);for(var v,d,m=e;e.prev!==e.next;)if(v=e.prev,d=e.next,f?l(e,r,i,f):u(e))t.push(v.i/n),t.push(e.i/n),t.push(d.i/n),z(e),e=d.next,m=d.next;else if((e=d)===m){h?1===h?a(e=s(o(e),t,n),t,n,r,i,f,2):2===h&&c(e,t,n,r,i,f):a(o(e),t,n,r,i,f,1);break}}}function u(e){var t=e.prev,n=e,r=e.next;if(y(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(m(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&y(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function l(e,t,n,r){var i=e.prev,o=e,a=e.next;if(y(i,o,a)>=0)return!1;for(var u=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,l=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,s=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,c=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,f=x(u,l,t,n,r),h=x(s,c,t,n,r),v=e.prevZ,d=e.nextZ;v&&v.z>=f&&d&&d.z<=h;){if(v!==e.prev&&v!==e.next&&m(i.x,i.y,o.x,o.y,a.x,a.y,v.x,v.y)&&y(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,d!==e.prev&&d!==e.next&&m(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&y(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;v&&v.z>=f;){if(v!==e.prev&&v!==e.next&&m(i.x,i.y,o.x,o.y,a.x,a.y,v.x,v.y)&&y(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;d&&d.z<=h;){if(d!==e.prev&&d!==e.next&&m(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&y(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function s(e,t,n){var r=e;do{var i=r.prev,a=r.next.next;!p(i,a)&&g(i,r,r.next,a)&&w(i,a)&&w(a,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(a.i/n),z(r),z(r.next),r=e=a),r=r.next}while(r!==e);return o(r)}function c(e,t,n,r,i,u){var l=e;do{for(var s=l.next.next;s!==l.prev;){if(l.i!==s.i&&_(l,s)){var c=R(l,s);return l=o(l,l.next),c=o(c,c.next),a(l,t,n,r,i,u),void a(c,t,n,r,i,u)}s=s.next}l=l.next}while(l!==e)}function f(e,t){return e.x-t.x}function h(e,t){if(t=function(e,t){var n,r=t,i=e.x,o=e.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var u=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(u<=i&&u>a){if(a=u,u===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===a)return n;var l,s=n,c=n.x,f=n.y,h=1/0;r=n;do{i>=r.x&&r.x>=c&&i!==r.x&&m(o<f?i:a,o,c,f,o<f?a:i,o,r.x,r.y)&&(l=Math.abs(o-r.y)/(i-r.x),w(r,e)&&(l<h||l===h&&(r.x>n.x||r.x===n.x&&v(n,r)))&&(n=r,h=l)),r=r.next}while(r!==s);return n}(e,t)){var n=R(t,e);o(t,t.next),o(n,n.next)}}function v(e,t){return y(e.prev,e,t.prev)<0&&y(t.next,e,e.next)<0}function x(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function d(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function m(e,t,n,r,i,o,a,u){return(i-a)*(t-u)-(e-a)*(o-u)>=0&&(e-a)*(r-u)-(n-a)*(t-u)>=0&&(n-a)*(o-u)-(i-a)*(r-u)>=0}function _(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&g(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(w(e,t)&&w(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(y(e.prev,e,t.prev)||y(e,t.prev,t))||p(e,t)&&y(e.prev,e,e.next)>0&&y(t.prev,t,t.next)>0)}function y(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function p(e,t){return e.x===t.x&&e.y===t.y}function g(e,t,n,r){var i=A(y(e,t,n)),o=A(y(e,t,r)),a=A(y(n,r,e)),u=A(y(n,r,t));return i!==o&&a!==u||(!(0!==i||!b(e,n,t))||(!(0!==o||!b(e,r,t))||(!(0!==a||!b(n,e,r))||!(0!==u||!b(n,t,r)))))}function b(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function A(e){return e>0?1:e<0?-1:0}function w(e,t){return y(e.prev,e,e.next)<0?y(e,t,e.next)>=0&&y(e,e.prev,t)>=0:y(e,t,e.prev)<0||y(e,e.next,t)<0}function R(e,t){var n=new E(e.i,e.x,e.y),r=new E(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function S(e,t,n,r){var i=new E(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function z(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function E(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(e,t,n,r){for(var i=0,o=t,a=n-r;o<n;o+=r)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}e.exports=r,e.exports.default=r,r.deviation=function(e,t,n,r){var i=t&&t.length,o=i?t[0]*n:e.length,a=Math.abs(T(e,0,o,n));if(i)for(var u=0,l=t.length;u<l;u++){var s=t[u]*n,c=u<l-1?t[u+1]*n:e.length;a-=Math.abs(T(e,s,c,n))}var f=0;for(u=0;u<r.length;u+=3){var h=r[u]*n,v=r[u+1]*n,x=r[u+2]*n;f+=Math.abs((e[h]-e[x])*(e[v+1]-e[h+1])-(e[h]-e[v])*(e[x+1]-e[h+1]))}return 0===a&&0===f?0:Math.abs((f-a)/a)},r.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var a=0;a<t;a++)n.vertices.push(e[i][o][a]);i>0&&(r+=e[i-1].length,n.holes.push(r))}return n}},50:function(e,t,n){"use strict";n.r(t);var r=n(21),i=n.n(r),o=n(10),a=n.n(o),u=n(12),l=n.n(u),s=n(13),c=n.n(s),f=n(18),h=n.n(f),v=n(19),x=n.n(v),d=n(17),m=n.n(d),_=n(11),y=n(48),p=n.n(y);n(29);function g(){var e=a()(['\n            <canvas\n                id="map"\n                @mousemove="','"\n                @wheel="','"\n                @mouseout="','"\n                @touchstart="','"\n                @touchmove="','"\n            >\n            </canvas>\n        ']);return g=function(){return e},e}function b(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(){var e=a()(["\n            :host {\n                width: 100%;\n                height: 100%;\n                position: relative;\n                display: block;\n            }\n            #map {\n                width: 100%;\n                height: 100%;\n                max-width: 100%;\n                max-height: 100%;\n                display: block;\n                position: absolute;\n            }\n        "]);return w=function(){return e},e}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return x()(this,n)}}var S={},z=function(e){h()(n,e);var t=R(n);function n(){var e;return l()(this,n),(e=t.call(this)).zoom_scale=1,e.zoom_center=[0,0],e.min=[0,0],e.max=[0,0],e.current_hover=null,e}return c()(n,null,[{key:"properties",get:function(){return{locations:{type:Array}}}},{key:"styles",get:function(){return Object(_.b)(w())}}]),c()(n,[{key:"setCenterAndScale",value:function(e,t){this.zoom_center=e,this.zoom_scale=t}},{key:"clientPosToMapPos",value:function(e){var t=this.shadowRoot.getElementById("map").getBoundingClientRect(),n=this.generateTranslateAndScale(),r=i()(n,2),o=(r[0],r[1]),a=[2*(e[0]-t.x)/t.width-1,1-2*(e[1]-t.y)/t.height];return[a[0]/o[0]+this.zoom_center[0],a[1]/o[1]+this.zoom_center[1]]}},{key:"clientPosToLocationPos",value:function(e){var t=this.shadowRoot.getElementById("map").getBoundingClientRect(),n=this.generateTranslateAndScale(),r=i()(n,2),o=r[0],a=r[1],u=[2*(e[0]-t.x)/t.width-1,1-2*(e[1]-t.y)/t.height];return[u[0]/a[0]-o[0],u[1]/a[1]-o[1]]}},{key:"locationPosToClientPos",value:function(e){var t=this.shadowRoot.getElementById("map").getBoundingClientRect(),n=this.generateTranslateAndScale(),r=i()(n,2),o=r[0],a=r[1],u=[(e[0]+o[0])*a[0],(e[1]+o[1])*a[1]];return[(u[0]+1)/2*t.width+t.x,(1-u[1])/2*t.height+t.y]}},{key:"handleMouseMove",value:function(e){var t,n=this.clientPosToLocationPos([e.clientX,e.clientY]),r=b(this.locations);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.min[0]<=n[0]&&i.min[1]<=n[1]&&i.max[0]>=n[0]&&i.max[1]>=n[1]){var o,a=b(S[i.id].polygons);try{for(a.s();!(o=a.n()).done;){var u=o.value;if(u.min[0]<=n[0]&&u.min[1]<=n[1]&&u.max[0]>=n[0]&&u.max[1]>=n[1])for(var l=0;l<u.triangles.length;l+=3){var s=[u.vertices[2*u.triangles[l]],u.vertices[2*u.triangles[l]+1]],c=[u.vertices[2*u.triangles[l+1]],u.vertices[2*u.triangles[l+1]+1]],f=[u.vertices[2*u.triangles[l+2]],u.vertices[2*u.triangles[l+2]+1]];function h(e,t,n){return(e[0]-n[0])*(t[1]-n[1])-(t[0]-n[0])*(e[1]-n[1])}var v=h(n,s,c),x=h(n,c,f),d=h(n,f,s);if(!(v<0||x<0||d<0)||!(v>0||x>0||d>0)){this.current_hover=i.id;var m=new Event("hover");return m.location=i,m.position=this.locationPosToClientPos([(u.min[0]+u.max[0])/2,(u.min[1]+u.max[1])/2]),void this.dispatchEvent(m)}}}}catch(e){a.e(e)}finally{a.f()}}}}catch(e){r.e(e)}finally{r.f()}this.handleMouseOut()}},{key:"handleMouseOut",value:function(){this.current_hover=null;var e=new Event("hover");e.location=null,e.position=null,this.dispatchEvent(e)}},{key:"handleTouchStart",value:function(e){1===e.touches.length?this.handleMouseMove({clientX:e.touches[0].clientX,clientY:e.touches[0].clientY}):this.handleMouseOut(e)}},{key:"generateTranslateAndScale",value:function(){var e=this.max[0]-this.min[0],t=this.max[1]-this.min[1];return e/this.current_size[0]>t/this.current_size[1]?[[-this.min[0]-e/2-this.zoom_center[0],-this.min[1]-t/2-this.zoom_center[1]],[2/e*this.zoom_scale,this.current_size[0]/this.current_size[1]*-2/e*this.zoom_scale],[1,-this.current_size[0]/this.current_size[1]]]:[[-this.min[0]-e/2-this.zoom_center[0],-this.min[1]-t/2-this.zoom_center[1]],[this.current_size[1]/this.current_size[0]*2/t*this.zoom_scale,-2/t*this.zoom_scale],[this.current_size[1]/this.current_size[0],-1]]}},{key:"renderMapInCanvas",value:function(){if(this.last_center!=this.zoom_center||this.last_scale!=this.zoom_scale||this.last_hover!=this.current_hover||this.last_size!=this.current_size){var e=this.webgl_data.context,t=this.webgl_data.fill_data,n=this.webgl_data.stroke_data,r=this.generateTranslateAndScale(),o=i()(r,3),a=o[0],u=o[1],l=o[2];e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT);var s,c=b(this.locations);try{for(c.s();!(s=c.n()).done;){var f=s.value,h=S[f.id];e.useProgram(n.shader_program),e.uniform2fv(n.translate_uniform,a),e.uniform2fv(n.scale_uniform,u),e.uniform2fv(n.scale2_uniform,l),e.uniform1f(n.width_uniform,.005),e.uniform3fv(n.color_uniform,[.271,.302,.38]);var v,x=b(h.polygons);try{for(x.s();!(v=x.n()).done;){var d=v.value;e.bindBuffer(e.ARRAY_BUFFER,d.gl_outline_position_buffer),e.vertexAttribPointer(n.position_attribute,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(n.position_attribute),e.bindBuffer(e.ARRAY_BUFFER,d.gl_outline_normal_buffer),e.vertexAttribPointer(n.normal_attribute,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(n.normal_attribute);var m,_=0,y=b(d.coords);try{for(y.s();!(m=y.n()).done;){var p=m.value;e.drawArrays(e.TRIANGLE_STRIP,4*_,4*(p.length+1)),_+=p.length+1}}catch(e){y.e(e)}finally{y.f()}}}catch(e){x.e(e)}finally{x.f()}e.useProgram(t.shader_program),e.uniform2fv(t.translate_uniform,a),e.uniform2fv(t.scale_uniform,u),f.id===this.current_hover?e.uniform3fv(t.color_uniform,f.color.map((function(e){return.8*e}))):e.uniform3fv(t.color_uniform,f.color);var g,A=b(h.polygons);try{for(A.s();!(g=A.n()).done;){var w=g.value;e.bindBuffer(e.ARRAY_BUFFER,w.gl_position_buffer),e.vertexAttribPointer(t.position_attribute,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(t.position_attribute),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,w.gl_index_buffer),e.drawElements(e.TRIANGLES,w.triangles.length,e.UNSIGNED_SHORT,0)}}catch(e){A.e(e)}finally{A.f()}}}catch(e){c.e(e)}finally{c.f()}this.last_center=this.zoom_center,this.last_scale=this.zoom_scale,this.last_hover=this.current_hover,this.last_size=this.current_size}window.requestAnimationFrame(this.renderMapInCanvas.bind(this))}},{key:"firstUpdated",value:function(){var e=this,t=this.shadowRoot.getElementById("map");this.current_size=[t.width,t.height];var n=t.getContext("webgl")||t.getContext("experimental-webgl");function r(e,t){var r=n.createShader(n.VERTEX_SHADER);n.shaderSource(r,e),n.compileShader(r);var i=n.createShader(n.FRAGMENT_SHADER);n.shaderSource(i,t),n.compileShader(i);var o=n.createProgram();return n.attachShader(o,r),n.attachShader(o,i),n.linkProgram(o),o}var i,o=r("\nattribute vec2 aVertexPosition;\n\nuniform vec2 uTranslate;\nuniform vec2 uScale;\n\nvoid main() {\n    gl_Position = vec4((aVertexPosition + uTranslate) * uScale, 0.0, 1.0);\n}\n","\n#ifdef GL_ES\n    precision highp float;\n#endif\n    \nuniform vec3 uFillColor;\n\nvoid main() {\n    gl_FragColor = vec4(uFillColor, 1.0);\n}\n"),a=n.getAttribLocation(o,"aVertexPosition"),u=n.getUniformLocation(o,"uTranslate"),l=n.getUniformLocation(o,"uScale"),s=n.getUniformLocation(o,"uFillColor"),c=r("\nattribute vec2 aVertexPosition;\nattribute vec2 aVertexNormal;\n\nuniform vec2 uTranslate;\nuniform vec2 uScale;\nuniform vec2 uStrokeScale;\nuniform float uWidth;\n\nvoid main() {\n    gl_Position = vec4(\n        (aVertexPosition + uTranslate) * uScale + normalize(aVertexNormal) * uWidth * uStrokeScale,\n        0.0, 1.0);\n}\n","\n#ifdef GL_ES\n    precision highp float;\n#endif\n    \nuniform vec3 uStrokeColor;\n\nvoid main() {\n    gl_FragColor = vec4(uStrokeColor, 1.0);\n}\n    "),f=n.getAttribLocation(c,"aVertexPosition"),h=n.getAttribLocation(c,"aVertexNormal"),v=n.getUniformLocation(c,"uTranslate"),x=n.getUniformLocation(c,"uScale"),d=n.getUniformLocation(c,"uStrokeScale"),m=n.getUniformLocation(c,"uWidth"),_=n.getUniformLocation(c,"uStrokeColor"),y=b(this.locations);try{for(y.s();!(i=y.n()).done;){var p,g=i.value,A=b(S[g.id].polygons);try{for(A.s();!(p=A.n()).done;){var w=p.value,R=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,R),n.bufferData(n.ARRAY_BUFFER,new Float32Array(w.vertices),n.STATIC_DRAW);var z=n.createBuffer();n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,z),n.bufferData(n.ELEMENT_ARRAY_BUFFER,new Uint16Array(w.triangles),n.STATIC_DRAW);var E=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,E),n.bufferData(n.ARRAY_BUFFER,new Float32Array(w.outline_vertices),n.STATIC_DRAW);var T=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,T),n.bufferData(n.ARRAY_BUFFER,new Float32Array(w.outline_normals),n.STATIC_DRAW),w.gl_position_buffer=R,w.gl_index_buffer=z,w.gl_outline_position_buffer=E,w.gl_outline_normal_buffer=T}}catch(e){A.e(e)}finally{A.f()}}}catch(e){y.e(e)}finally{y.f()}var F=function(){t.width=t.clientWidth,t.height=t.clientHeight,n.viewport(0,0,t.width,t.height),e.current_size=[t.width,t.height]};window.addEventListener("resize",F),F(),this.webgl_data={canvas:t,context:n,fill_data:{shader_program:o,position_attribute:a,translate_uniform:u,scale_uniform:l,color_uniform:s},stroke_data:{shader_program:c,position_attribute:f,normal_attribute:h,translate_uniform:v,scale_uniform:x,scale2_uniform:d,width_uniform:m,color_uniform:_}},this.renderMapInCanvas()}},{key:"disconnectedCallback",value:function(){var e;if(null!==(e=this.webgl_data)&&void 0!==e&&e.context){var t,n=this.webgl_data.context,r=b(this.locations);try{for(r.s();!(t=r.n()).done;){var i,o=t.value,a=b(S[o.id].polygons);try{for(a.s();!(i=a.n()).done;){var u=i.value;n.deleteBuffer(u.gl_position_buffer),n.deleteBuffer(u.gl_index_buffer),n.deleteBuffer(u.gl_outline_position_buffer),n.deleteBuffer(u.gl_outline_normal_buffer)}}catch(e){a.e(e)}finally{a.f()}}}catch(e){r.e(e)}finally{r.f()}n.getAttachedShaders(this.webgl_data.fill_data.shader_program).forEach((function(e){n.deleteShader(e)})),n.deleteProgram(this.webgl_data.fill_data.fill_shader_program),n.getAttachedShaders(this.webgl_data.stroke_data.shader_program).forEach((function(e){n.deleteShader(e)})),n.deleteProgram(this.webgl_data.stroke_data.shader_program)}}},{key:"render",value:function(){var e=this.locations.filter((function(e){return e})).map((function(e){return e.min})).reduce((function(e,t){return[Math.min(e[0],t[0]),Math.min(e[1],t[1])]})),t=this.locations.filter((function(e){return e})).map((function(e){return e.max})).reduce((function(e,t){return[Math.max(e[0],t[0]),Math.max(e[1],t[1])]}));return this.min=e,this.max=t,this.locations.forEach((function(e){e.color=e.color.map((function(e){return e/255})),e&&!S[e.id]&&(S[e.id]={polygons:e.coords.map((function(e){var t=p.a.flatten(e),n=p()(t.vertices,t.holes,t.dimensions);return{coords:e,vertices:t.vertices,triangles:n,outline_vertices:e.map((function(e){return e.reduce((function(e,t){return e.concat([t,t,t,t])}),[]).concat([e[0],e[0],e[0],e[0]])})).flat(3),outline_normals:e.map((function(e){return e.reduce((function(t,n,r){var i=e[(e.length+r-1)%e.length],o=[n[0]-i[0],n[1]-i[1]],a=e[(r+1)%e.length],u=[a[0]-n[0],a[1]-n[1]];return t.concat([[o[1],-o[0]],[-o[1],o[0]],[u[1],-u[0]],[-u[1],u[0]]])}),[]).concat((t=e[0],n=e[e.length-1],r=[t[0]-n[0],t[1]-n[1]],i=e[1],o=[i[0]-t[0],i[1]-t[1]],[[r[1],-r[0]],[-r[1],r[0]],[o[1],-o[0]],[-o[1],o[0]]]));var t,n,r,i,o})).flat(3),min:e.flat().reduce((function(e,t){return[Math.min(e[0],t[0]),Math.min(e[1],t[1])]})),max:e.flat().reduce((function(e,t){return[Math.max(e[0],t[0]),Math.max(e[1],t[1])]}))}}))})})),Object(_.c)(g(),this.handleMouseMove,this.handleMouseMove,this.handleMouseOut,this.handleTouchStart,this.handleTouchStart)}},{key:"center",get:function(){return this.zoom_center}},{key:"scale",get:function(){return this.zoom_scale}}]),n}(_.a);customElements.define("map-backend",z)}}]);