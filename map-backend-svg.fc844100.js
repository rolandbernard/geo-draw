"use strict";(self.webpackChunkgeo_draw=self.webpackChunkgeo_draw||[]).push([[968],{971:(t,n,e)=>{e.r(n);var o,i,a,r,c=e(168),u=e(671),s=e(144),l=e(340),h=e(215),d=e(120),f=e(392),m=e(959),v=e(293),p=e(466);var y=function(t){(0,l.Z)(g,t);var n,e,y=(n=g,e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,o=(0,d.Z)(n);if(e){var i=(0,d.Z)(this).constructor;t=Reflect.construct(o,arguments,i)}else t=o.apply(this,arguments);return(0,h.Z)(this,t)});function g(){var t;return(0,u.Z)(this,g),(t=y.call(this)).zoom_scale=1,t.zoom_center=[0,0],t}return(0,s.Z)(g,[{key:"center",get:function(){return this.zoom_center}},{key:"scale",get:function(){return this.zoom_scale}},{key:"setCenterAndScale",value:function(t,n){this.zoom_center=t,this.zoom_scale=n,this.shadowRoot.getElementById("map").style.transform="scale(".concat(this.zoom_scale,") translate(").concat(-this.zoom_center[0],"%,").concat(-this.zoom_center[1],"%)")}},{key:"clientPosToMapPos",value:function(t){var n=this.shadowRoot.getElementById("map").getBoundingClientRect();return[(t[0]-n.x-n.width/2)/n.width*100,(t[1]-n.y-n.height/2)/n.height*100]}},{key:"handleMouseMove",value:function(t){var n,e,o=t.target,i=o;if("path"===(null===(n=i)||void 0===n?void 0:n.tagName)&&(i=i.parentNode),null!==(e=i)&&void 0!==e&&e.location_data){var a,r=null===(a=i)||void 0===a?void 0:a.location_data,c=o.getBoundingClientRect(),u=[c.x+c.width/2,c.y+c.height/2],s=new Event("hover");s.location=r,s.position=u,this.dispatchEvent(s)}else{var l=new Event("hover");l.location=null,l.position=null,this.dispatchEvent(l)}}},{key:"handleMouseOut",value:function(){var t=new Event("hover");t.location=null,t.position=null,this.dispatchEvent(t)}},{key:"handleTouchStart",value:function(t){1===t.touches.length?this.handleMouseMove(t):this.handleMouseOut(t)}},{key:"updated",value:function(){var t=this;window.requestAnimationFrame((function n(){var e=t.shadowRoot.getElementById("map");e?window.requestAnimationFrame((function(){window.requestAnimationFrame((function(){e.style.transform="scale(".concat(t.zoom_scale,") translate(").concat(-t.zoom_center[0],"%,").concat(-t.zoom_center[1],"%)"),e.style.opacity=1}))})):window.requestAnimationFrame(n)}))}},{key:"render",value:function(){var t=p.Z.project(this.locations.filter((function(t){return t})).map((function(t){return t.min})).reduce((function(t,n){return[Math.min(t[0],n[0]),Math.min(t[1],n[1])]}))),n=p.Z.project(this.locations.filter((function(t){return t})).map((function(t){return t.max})).reduce((function(t,n){return[Math.max(t[0],n[0]),Math.max(t[1],n[1])]}))),e=[n[1],t[1]];t[1]=e[0],n[1]=e[1];var r=Math.max(n[0]-t[0],n[1]-t[1]),u=5*Math.max(window.innerWidth,window.innerHeight);return this.locations.forEach((function(n){n&&(n.svg=n.coords.map((function(n){return(0,f.YP)(o||(o=(0,c.Z)(['<path d="','"/>'])),n.map((function(n,e){return(0==e?n:n.reverse()).map(p.Z.project).map((function(n){return[Math.round((0,v.U)(n[0],t[0],t[0]+r,0,u)),Math.round((0,v.U)(n[1],t[1],t[1]+r,0,u))]})).filter((function(t,n,e){var o,i;return t[0]!==(null===(o=e[n+1])||void 0===o?void 0:o[0])||t[1]!==(null===(i=e[n+1])||void 0===i?void 0:i[1])})).map((function(t,n){return 0==n?"M"+t[0]+","+t[1]:"L"+t[0]+","+t[1]})).join(" ")+" z"})).join(" "))})))})),(0,f.dy)(i||(i=(0,c.Z)(['\n            <svg\n                id="map"\n                viewBox="','"\n                @mousemove="','"\n                @wheel="','"\n                @mouseout="','"\n                @touchstart="','"\n                @touchmove="','"\n            >\n                ',"\n            </svg>\n        "])),Math.round((0,v.U)(t[0],t[0],t[0]+r,0,u))+" "+Math.round((0,v.U)(t[1],t[1],t[1]+r,0,u))+" "+Math.round((0,v.U)(n[0],t[0],t[0]+r,0,u))+" "+Math.round((0,v.U)(n[1],t[1],t[1]+r,0,u)),this.handleMouseMove,this.handleMouseMove,this.handleMouseOut,this.handleTouchStart,this.handleTouchStart,this.locations.map((function(t){return(0,f.YP)(a||(a=(0,c.Z)(['\n                    <g\n                        class="geometry"\n                        style="','"\n                        .location_data="','"\n                    >\n                        ',"\n                    </g>\n                "])),(0,m.V)({fill:"rgb(".concat(t.color[0],",").concat(t.color[1],",").concat(t.color[2],")")}),t,null==t?void 0:t.svg)})))}}],[{key:"properties",get:function(){return{locations:{type:Array}}}},{key:"styles",get:function(){return(0,f.iv)(r||(r=(0,c.Z)(["\n            :host {\n                width: 100%;\n                height: 100%;\n                position: relative;\n                display: block;\n            }\n            #map {\n                width: 100%;\n                height: 100%;\n                max-width: 100%;\n                max-height: 100%;\n                transform: scale(5);\n                opacity: 0.001;\n                will-change: transform, opacity;\n                stroke: var(--background-darkish);\n                stroke-width: 0.125%;\n                stroke-linejoin: round;\n                paint-order: stroke fill;\n                display: block;\n                position: absolute;\n            }\n            svg#map g:hover {\n                fill-opacity: 0.75;\n            }\n        "])))}}]),g}(f.oi);customElements.define("map-backend",y)}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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S2pCQyxFQUFBQSxFQUFBQSxJQUFQLHdVQUlZakIsS0FBS2MsT0FBTWxCLEVBQUFBLEVBQUFBLEdBQUlMLEVBQUksR0FBSUEsRUFBSSxHQUFJQSxFQUFJLEdBQUtXLEVBQVksRUFBR0MsSUFBYSxJQUNwRUgsS0FBS2MsT0FBTWxCLEVBQUFBLEVBQUFBLEdBQUlMLEVBQUksR0FBSUEsRUFBSSxHQUFJQSxFQUFJLEdBQUtXLEVBQVksRUFBR0MsSUFBYSxJQUNwRUgsS0FBS2MsT0FBTWxCLEVBQUFBLEVBQUFBLEdBQUlLLEVBQUksR0FBSVYsRUFBSSxHQUFJQSxFQUFJLEdBQUtXLEVBQVksRUFBR0MsSUFBYSxJQUNwRUgsS0FBS2MsT0FBTWxCLEVBQUFBLEVBQUFBLEdBQUlLLEVBQUksR0FBSVYsRUFBSSxHQUFJQSxFQUFJLEdBQUtXLEVBQVksRUFBR0MsSUFFN0NoRCxLQUFLNkIsZ0JBQ1Q3QixLQUFLNkIsZ0JBQ0Y3QixLQUFLOEIsZUFDSDlCLEtBQUsrRCxpQkFDTi9ELEtBQUsrRCxpQkFFakIvRCxLQUFLc0MsVUFBVUcsS0FBSSxTQUFDRCxHQUFELE9BQVVZLEVBQUFBLEVBQUFBLElBQVQsSUFBRCx1UUFHSlksRUFBQUEsRUFBQUEsR0FBUyxDQUNkQyxLQUFNLE9BQUYsT0FBU3pCLEVBQUkwQixNQUFNLEdBQW5CLFlBQXlCMUIsRUFBSTBCLE1BQU0sR0FBbkMsWUFBeUMxQixFQUFJMEIsTUFBTSxHQUFuRCxPQUVVMUIsRUFFaEJBLE1BQUFBLE9BUlcsRUFRWEEsRUFBS1ksWSx1QkE3SzNCLFdBQ0ksTUFBTyxDQUNIZCxVQUFXLENBQUU2QixLQUFNQyxVLGtCQUkzQixXQUNJLE9BQU9DLEVBQUFBLEVBQUFBLElBQVAsaXpCLEVBVEZ4RSxDQUFzQnlFLEVBQUFBLElBd0w1QkMsZUFBZUMsT0FBTyxjQUFlM0UiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nZW8tZHJhdy8uL3NyYy9tYXAvbWFwLWJhY2tlbmQtc3ZnLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlxuaW1wb3J0IHsgTGl0RWxlbWVudCwgaHRtbCwgc3ZnLCBjc3MgfSBmcm9tICdsaXQnO1xuaW1wb3J0IHsgc3R5bGVNYXAgfSBmcm9tICdsaXQvZGlyZWN0aXZlcy9zdHlsZS1tYXAuanMnO1xuXG5pbXBvcnQgeyBtYXAgfSBmcm9tICcuLi91dGlsJztcbmltcG9ydCBNYXBSZW5kZXJlciBmcm9tICcuL21hcC1yZW5kZXJlcic7XG5cbmNsYXNzIE1hcEJhY2tlbmRTdmcgZXh0ZW5kcyBMaXRFbGVtZW50IHtcblxuICAgIHN0YXRpYyBnZXQgcHJvcGVydGllcygpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGxvY2F0aW9uczogeyB0eXBlOiBBcnJheSB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzdGF0aWMgZ2V0IHN0eWxlcygpIHtcbiAgICAgICAgcmV0dXJuIGNzc2BcbiAgICAgICAgICAgIDpob3N0IHtcbiAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDEwMCU7XG4gICAgICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICAgICAgICAgICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgI21hcCB7XG4gICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgICAgICAgICAgIG1heC13aWR0aDogMTAwJTtcbiAgICAgICAgICAgICAgICBtYXgtaGVpZ2h0OiAxMDAlO1xuICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogc2NhbGUoNSk7XG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMC4wMDE7XG4gICAgICAgICAgICAgICAgd2lsbC1jaGFuZ2U6IHRyYW5zZm9ybSwgb3BhY2l0eTtcbiAgICAgICAgICAgICAgICBzdHJva2U6IHZhcigtLWJhY2tncm91bmQtZGFya2lzaCk7XG4gICAgICAgICAgICAgICAgc3Ryb2tlLXdpZHRoOiAwLjEyNSU7XG4gICAgICAgICAgICAgICAgc3Ryb2tlLWxpbmVqb2luOiByb3VuZDtcbiAgICAgICAgICAgICAgICBwYWludC1vcmRlcjogc3Ryb2tlIGZpbGw7XG4gICAgICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7XG4gICAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3ZnI21hcCBnOmhvdmVyIHtcbiAgICAgICAgICAgICAgICBmaWxsLW9wYWNpdHk6IDAuNzU7XG4gICAgICAgICAgICB9XG4gICAgICAgIGA7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnpvb21fc2NhbGUgPSAxO1xuICAgICAgICB0aGlzLnpvb21fY2VudGVyID0gWzAsIDBdO1xuICAgIH1cbiAgICBcbiAgICBnZXQgY2VudGVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy56b29tX2NlbnRlcjtcbiAgICB9XG5cbiAgICBnZXQgc2NhbGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnpvb21fc2NhbGU7XG4gICAgfVxuXG4gICAgc2V0Q2VudGVyQW5kU2NhbGUoY2VudGVyLCBzY2FsZSkge1xuICAgICAgICB0aGlzLnpvb21fY2VudGVyID0gY2VudGVyO1xuICAgICAgICB0aGlzLnpvb21fc2NhbGUgPSBzY2FsZTtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMuc2hhZG93Um9vdC5nZXRFbGVtZW50QnlJZCgnbWFwJyk7XG4gICAgICAgIGVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gYHNjYWxlKCR7dGhpcy56b29tX3NjYWxlfSkgdHJhbnNsYXRlKCR7LXRoaXMuem9vbV9jZW50ZXJbMF19JSwkey10aGlzLnpvb21fY2VudGVyWzFdfSUpYDtcbiAgICB9XG4gICAgXG4gICAgY2xpZW50UG9zVG9NYXBQb3MoY2xpZW50X3Bvcykge1xuICAgICAgICBjb25zdCBtYXAgPSB0aGlzLnNoYWRvd1Jvb3QuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpO1xuICAgICAgICBjb25zdCBtYXBfcG9zID0gbWFwLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgKGNsaWVudF9wb3NbMF0gLSBtYXBfcG9zLnggLSBtYXBfcG9zLndpZHRoIC8gMikgLyBtYXBfcG9zLndpZHRoICogMTAwLFxuICAgICAgICAgICAgKGNsaWVudF9wb3NbMV0gLSBtYXBfcG9zLnkgLSBtYXBfcG9zLmhlaWdodCAvIDIpIC8gbWFwX3Bvcy5oZWlnaHQgKiAxMDAsXG4gICAgICAgIF07XG4gICAgfVxuXG4gICAgaGFuZGxlTW91c2VNb3ZlKGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IGJhc2VfZWxlbSA9IGV2ZW50LnRhcmdldDtcbiAgICAgICAgbGV0IGVsZW0gPSBiYXNlX2VsZW07XG4gICAgICAgIGlmKGVsZW0/LnRhZ05hbWUgPT09ICdwYXRoJykge1xuICAgICAgICAgICAgZWxlbSA9IGVsZW0ucGFyZW50Tm9kZTtcbiAgICAgICAgfVxuICAgICAgICBpZihlbGVtPy5sb2NhdGlvbl9kYXRhKSB7XG4gICAgICAgICAgICBjb25zdCBsb2NhdGlvbiA9IGVsZW0/LmxvY2F0aW9uX2RhdGE7XG4gICAgICAgICAgICBjb25zdCBlbGVtX3BvcyA9IGJhc2VfZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gW2VsZW1fcG9zLnggKyBlbGVtX3Bvcy53aWR0aCAvIDIsIGVsZW1fcG9zLnkgKyBlbGVtX3Bvcy5oZWlnaHQgLyAyXTtcbiAgICAgICAgICAgIGNvbnN0IG15X2V2ZW50ID0gbmV3IEV2ZW50KCdob3ZlcicpO1xuICAgICAgICAgICAgbXlfZXZlbnQubG9jYXRpb24gPSBsb2NhdGlvbjtcbiAgICAgICAgICAgIG15X2V2ZW50LnBvc2l0aW9uID0gcG9zaXRpb247XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQobXlfZXZlbnQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgbXlfZXZlbnQgPSBuZXcgRXZlbnQoJ2hvdmVyJyk7XG4gICAgICAgICAgICBteV9ldmVudC5sb2NhdGlvbiA9IG51bGw7XG4gICAgICAgICAgICBteV9ldmVudC5wb3NpdGlvbiA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQobXlfZXZlbnQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaGFuZGxlTW91c2VPdXQoKSB7XG4gICAgICAgIGNvbnN0IG15X2V2ZW50ID0gbmV3IEV2ZW50KCdob3ZlcicpO1xuICAgICAgICBteV9ldmVudC5sb2NhdGlvbiA9IG51bGw7XG4gICAgICAgIG15X2V2ZW50LnBvc2l0aW9uID0gbnVsbDtcbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KG15X2V2ZW50KTtcbiAgICB9XG4gICAgXG4gICAgaGFuZGxlVG91Y2hTdGFydChldmVudCkge1xuICAgICAgICBpZihldmVudC50b3VjaGVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVNb3VzZU1vdmUoZXZlbnQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVNb3VzZU91dChldmVudCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB1cGRhdGVkKCkge1xuICAgICAgICAvLyBUaGlzIGlzIGEgc3R1cGlkIHRyaWNrIHRvIGdldCBjaHJvbWUgdG8gcmVuZGVyIGF0IGEgaGlnaGVyIHJlc29sdXRpb25cbiAgICAgICAgY29uc3QgYW5pbWF0aW9uRnJhbWVDYWxsYmFjayA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLnNoYWRvd1Jvb3QuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpO1xuICAgICAgICAgICAgaWYoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gYHNjYWxlKCR7dGhpcy56b29tX3NjYWxlfSkgdHJhbnNsYXRlKCR7LXRoaXMuem9vbV9jZW50ZXJbMF19JSwkey10aGlzLnpvb21fY2VudGVyWzFdfSUpYDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUub3BhY2l0eSA9IDE7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGlvbkZyYW1lQ2FsbGJhY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGlvbkZyYW1lQ2FsbGJhY2spO1xuICAgIH1cbiAgICBcbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IG1pbiA9IE1hcFJlbmRlcmVyLnByb2plY3QoXG4gICAgICAgICAgICB0aGlzLmxvY2F0aW9ucy5maWx0ZXIobG9jID0+IGxvYykubWFwKGxvYyA9PiBsb2MubWluKVxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoKGEsIGIpID0+IFtNYXRoLm1pbihhWzBdLCBiWzBdKSwgTWF0aC5taW4oYVsxXSwgYlsxXSldKSk7XG4gICAgICAgIGNvbnN0IG1heCA9IE1hcFJlbmRlcmVyLnByb2plY3QoXG4gICAgICAgICAgICB0aGlzLmxvY2F0aW9ucy5maWx0ZXIobG9jID0+IGxvYykubWFwKGxvYyA9PiBsb2MubWF4KVxuICAgICAgICAgICAgICAgIC5yZWR1Y2UoKGEsIGIpID0+IFtNYXRoLm1heChhWzBdLCBiWzBdKSwgTWF0aC5tYXgoYVsxXSwgYlsxXSldKSk7XG4gICAgICAgIFttaW5bMV0sIG1heFsxXV0gPSBbbWF4WzFdLCBtaW5bMV1dXG4gICAgICAgIGNvbnN0IHRvdGFsX2RpZmYgPSBNYXRoLm1heChtYXhbMF0gLSBtaW5bMF0sIG1heFsxXSAtIG1pblsxXSk7XG4gICAgICAgIGNvbnN0IG1heF9zaXplID0gTWF0aC5tYXgod2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCkgKiA1O1xuICAgICAgICB0aGlzLmxvY2F0aW9ucy5mb3JFYWNoKGxvYyA9PiB7XG4gICAgICAgICAgICBpZihsb2MpIHtcbiAgICAgICAgICAgICAgICBsb2Muc3ZnID0gbG9jLmNvb3Jkcy5tYXAocG9seSA9PiAoXG4gICAgICAgICAgICAgICAgICAgIHN2Z2A8cGF0aCBkPVwiJHtwb2x5Lm1hcCgocGFydCwgaSkgPT4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgKGkgPT0gMCA/IHBhcnQgOiBwYXJ0LnJldmVyc2UoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKE1hcFJlbmRlcmVyLnByb2plY3QpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChjb29yZCA9PiAoW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKG1hcChjb29yZFswXSwgbWluWzBdLCBtaW5bMF0gKyB0b3RhbF9kaWZmLCAwLCBtYXhfc2l6ZSkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLnJvdW5kKG1hcChjb29yZFsxXSwgbWluWzFdLCBtaW5bMV0gKyB0b3RhbF9kaWZmLCAwLCBtYXhfc2l6ZSkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSkpLmZpbHRlcigoY29vcmQsIGksIGFycikgPT4gY29vcmRbMF0gIT09IGFycltpICsgMV0/LlswXSB8fCBjb29yZFsxXSAhPT0gYXJyW2kgKyAxXT8uWzFdKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoKGNvb3JkLCBpKSA9PiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPT0gMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyAnTScgKyBjb29yZFswXSArICcsJyArIGNvb3JkWzFdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICdMJyArIGNvb3JkWzBdICsgJywnICsgY29vcmRbMV1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApKS5qb2luKCcgJykgKyAnIHonXG4gICAgICAgICAgICAgICAgICAgICAgICApKS5qb2luKCcgJylcbiAgICAgICAgICAgICAgICAgICAgfVwiLz5gXG4gICAgICAgICAgICAgICAgKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gaHRtbGBcbiAgICAgICAgICAgIDxzdmdcbiAgICAgICAgICAgICAgICBpZD1cIm1hcFwiXG4gICAgICAgICAgICAgICAgdmlld0JveD1cIiR7XG4gICAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQobWFwKG1pblswXSwgbWluWzBdLCBtaW5bMF0gKyB0b3RhbF9kaWZmLCAwLCBtYXhfc2l6ZSkpICsgJyAnICsgXG4gICAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQobWFwKG1pblsxXSwgbWluWzFdLCBtaW5bMV0gKyB0b3RhbF9kaWZmLCAwLCBtYXhfc2l6ZSkpICsgJyAnICtcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5yb3VuZChtYXAobWF4WzBdLCBtaW5bMF0sIG1pblswXSArIHRvdGFsX2RpZmYsIDAsIG1heF9zaXplKSkgKyAnICcgKyBcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5yb3VuZChtYXAobWF4WzFdLCBtaW5bMV0sIG1pblsxXSArIHRvdGFsX2RpZmYsIDAsIG1heF9zaXplKSlcbiAgICAgICAgICAgICAgICB9XCJcbiAgICAgICAgICAgICAgICBAbW91c2Vtb3ZlPVwiJHt0aGlzLmhhbmRsZU1vdXNlTW92ZX1cIlxuICAgICAgICAgICAgICAgIEB3aGVlbD1cIiR7dGhpcy5oYW5kbGVNb3VzZU1vdmV9XCJcbiAgICAgICAgICAgICAgICBAbW91c2VvdXQ9XCIke3RoaXMuaGFuZGxlTW91c2VPdXR9XCJcbiAgICAgICAgICAgICAgICBAdG91Y2hzdGFydD1cIiR7dGhpcy5oYW5kbGVUb3VjaFN0YXJ0fVwiXG4gICAgICAgICAgICAgICAgQHRvdWNobW92ZT1cIiR7dGhpcy5oYW5kbGVUb3VjaFN0YXJ0fVwiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgJHt0aGlzLmxvY2F0aW9ucy5tYXAoKGxvYykgPT4gKHN2Z2BcbiAgICAgICAgICAgICAgICAgICAgPGdcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzPVwiZ2VvbWV0cnlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9XCIke3N0eWxlTWFwKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxsOiBgcmdiKCR7bG9jLmNvbG9yWzBdfSwke2xvYy5jb2xvclsxXX0sJHtsb2MuY29sb3JbMl19KWAsXG4gICAgICAgICAgICAgICAgICAgICAgICB9KX1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgLmxvY2F0aW9uX2RhdGE9XCIke2xvY31cIlxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAke2xvYz8uc3ZnfVxuICAgICAgICAgICAgICAgICAgICA8L2c+XG4gICAgICAgICAgICAgICAgYCkpfVxuICAgICAgICAgICAgPC9zdmc+XG4gICAgICAgIGA7XG4gICAgfVxuXG59XG5cbmN1c3RvbUVsZW1lbnRzLmRlZmluZSgnbWFwLWJhY2tlbmQnLCBNYXBCYWNrZW5kU3ZnKTtcbiJdLCJuYW1lcyI6WyJNYXBCYWNrZW5kU3ZnIiwiem9vbV9zY2FsZSIsInpvb21fY2VudGVyIiwidGhpcyIsImNlbnRlciIsInNjYWxlIiwic2hhZG93Um9vdCIsImdldEVsZW1lbnRCeUlkIiwic3R5bGUiLCJ0cmFuc2Zvcm0iLCJjbGllbnRfcG9zIiwibWFwX3BvcyIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsIngiLCJ3aWR0aCIsInkiLCJoZWlnaHQiLCJldmVudCIsImJhc2VfZWxlbSIsInRhcmdldCIsImVsZW0iLCJ0YWdOYW1lIiwicGFyZW50Tm9kZSIsImxvY2F0aW9uX2RhdGEiLCJsb2NhdGlvbiIsImVsZW1fcG9zIiwicG9zaXRpb24iLCJteV9ldmVudCIsIkV2ZW50IiwiZGlzcGF0Y2hFdmVudCIsInRvdWNoZXMiLCJsZW5ndGgiLCJoYW5kbGVNb3VzZU1vdmUiLCJoYW5kbGVNb3VzZU91dCIsIndpbmRvdyIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImFuaW1hdGlvbkZyYW1lQ2FsbGJhY2siLCJlbGVtZW50Iiwib3BhY2l0eSIsIm1pbiIsIk1hcFJlbmRlcmVyIiwibG9jYXRpb25zIiwiZmlsdGVyIiwibG9jIiwibWFwIiwicmVkdWNlIiwiYSIsImIiLCJNYXRoIiwibWF4IiwidG90YWxfZGlmZiIsIm1heF9zaXplIiwiaW5uZXJXaWR0aCIsImlubmVySGVpZ2h0IiwiZm9yRWFjaCIsInN2ZyIsImNvb3JkcyIsInBvbHkiLCJwYXJ0IiwiaSIsInJldmVyc2UiLCJjb29yZCIsInJvdW5kIiwiYXJyIiwiam9pbiIsImh0bWwiLCJoYW5kbGVUb3VjaFN0YXJ0Iiwic3R5bGVNYXAiLCJmaWxsIiwiY29sb3IiLCJ0eXBlIiwiQXJyYXkiLCJjc3MiLCJMaXRFbGVtZW50IiwiY3VzdG9tRWxlbWVudHMiLCJkZWZpbmUiXSwic291cmNlUm9vdCI6IiJ9